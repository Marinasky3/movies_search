{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React from 'react';\nimport { isEventSource } from '../../effects/ClickOutside';\nimport { useI18nContext } from '../../state/I18n';\nimport { OverlayTrigger } from '../OverlayTrigger';\nimport { Button as SelectButton } from '../Select';\nimport { TieredSelectContext } from './TieredSelect';\nimport { TieredSelectMenu } from './TieredSelectMenu';\nvar empty = [];\nvar hideKeys = {\n  overlay: ['Escape', 'Esc'],\n  target: ['Escape', 'Esc']\n};\nexport var LeafSelectionTieredSelect = React.forwardRef(function LeafSelectionTieredSelect(_a, ref) {\n  var className = _a.className,\n      _b = _a.disabled,\n      disabled = _b === void 0 ? false : _b,\n      _c = _a.error,\n      error = _c === void 0 ? false : _c,\n      _d = _a.loading,\n      loading = _d === void 0 ? false : _d,\n      onKeyDown = _a.onKeyDown,\n      _e = _a.options,\n      options = _e === void 0 ? empty : _e,\n      _f = _a.value,\n      value = _f === void 0 ? empty : _f,\n      props = __rest(_a, [\"className\", \"disabled\", \"error\", \"loading\", \"onKeyDown\", \"options\", \"value\"]);\n\n  var _g = React.useContext(TieredSelectContext),\n      afterHide = _g.afterHide,\n      afterShow = _g.afterShow,\n      beforeHide = _g.beforeHide,\n      beforeShow = _g.beforeShow,\n      block = _g.block,\n      getGroupId = _g.getGroupId,\n      getNextGroupId = _g.getNextGroupId,\n      getValueString = _g.getValueString,\n      i18nScope = _g.i18nScope,\n      isLeaf = _g.isLeaf,\n      onChange = _g.onChange,\n      onClear = _g.onClear,\n      onNavigate = _g.onNavigate,\n      onSearch = _g.onSearch,\n      tabIndex = _g.tabIndex;\n\n  var I18n = useI18nContext();\n  var tieredSelectMenuRef = React.useRef(null);\n  var tieredSelectButtonRef = React.useRef(null);\n  var clearRef = React.createRef();\n\n  var _h = React.useState(''),\n      valueString = _h[0],\n      setValueString = _h[1];\n\n  var _j = React.useState(null),\n      currentTier = _j[0],\n      setCurrentTier = _j[1]; // internal value used for navigation\n\n\n  var _k = React.useState(value),\n      internalValue = _k[0],\n      setInternalValue = _k[1]; // value to reset to if navigation occurs but no selection has been made\n\n\n  var _l = React.useState(value),\n      previousValue = _l[0],\n      setPreviousValue = _l[1]; // if value prop changes, update value state, current tier, and set button label\n  // else open to root\n\n\n  React.useEffect(function () {\n    var lastEntryInValue = value[value.length - 1];\n\n    if (value.length > 0) {\n      setInternalValue(value);\n      setPreviousValue(value);\n      setValueString(getValueString(value)); // show children of last tier in value if not a leaf node\n      // otherwise we want to show the parent of the last tier in value\n\n      if (isLeaf && !isLeaf(lastEntryInValue)) {\n        setCurrentTier(getNextGroupId(lastEntryInValue));\n      } else {\n        setCurrentTier(getGroupId(lastEntryInValue));\n      }\n    } else {\n      setCurrentTier(null);\n      setInternalValue([]);\n      setPreviousValue([]);\n      setValueString('');\n    }\n  }, [getGroupId, getValueString, getNextGroupId, isLeaf, value]);\n  var internalOnChange = React.useCallback(function (selection) {\n    setInternalValue(selection.value);\n    setPreviousValue(selection.value);\n    setValueString(getValueString(selection.value));\n    setCurrentTier(getGroupId(selection.item));\n    onChange(selection);\n  }, [getGroupId, onChange, getValueString]);\n  var internalOnNavigate = React.useCallback(function (nextGroupId, value) {\n    setInternalValue(value);\n    setCurrentTier(nextGroupId);\n    onNavigate && onNavigate(nextGroupId, value);\n  }, [onNavigate]);\n  var internalOnClear = React.useCallback(function (event) {\n    setValueString('');\n    setInternalValue([]);\n    setPreviousValue([]);\n    internalOnNavigate(null, []);\n    onClear && onClear(event);\n  }, [internalOnNavigate, onClear]);\n  var internalOnSearch = React.useCallback(function (event) {\n    onSearch && onSearch(event);\n  }, [onSearch]);\n  var internalBeforeHide = React.useCallback(function (e) {\n    var _a;\n\n    var isEscapeKey = e instanceof KeyboardEvent && (e.key === 'Escape' || e.key === 'Esc');\n    var isClickOutside = e instanceof MouseEvent && !isEventSource({\n      current: (_a = tieredSelectMenuRef === null || tieredSelectMenuRef === void 0 ? void 0 : tieredSelectMenuRef.current) === null || _a === void 0 ? void 0 : _a.el\n    }, e);\n    var lastValue = previousValue[previousValue.length - 1];\n\n    if (valueString && (isClickOutside || isEscapeKey)) {\n      setInternalValue(previousValue);\n\n      if (isLeaf && isLeaf(lastValue)) {\n        setCurrentTier(getGroupId(lastValue));\n      } else {\n        setCurrentTier(getNextGroupId(lastValue));\n      }\n    }\n\n    return beforeHide && beforeHide(e);\n  }, [beforeHide, getGroupId, getNextGroupId, isLeaf, tieredSelectMenuRef, previousValue, valueString]);\n  return React.createElement(OverlayTrigger, {\n    afterHide: afterHide,\n    afterShow: afterShow,\n    beforeHide: internalBeforeHide,\n    beforeShow: function (e) {\n      return beforeShow && e.target !== clearRef.current && beforeShow(e);\n    },\n    canFlip: true,\n    hideKeys: hideKeys,\n    overlay: React.createElement(TieredSelectMenu, __assign({\n      currentTier: currentTier,\n      options: options,\n      loading: loading,\n      menuRef: tieredSelectMenuRef,\n      onNavigate: internalOnNavigate,\n      onSearch: internalOnSearch,\n      onChange: internalOnChange,\n      value: internalValue,\n      previousValue: previousValue\n    }, props)),\n    placement: \"bottom-left\",\n    ref: ref,\n    trigger: \"click\"\n  }, React.createElement(SelectButton, {\n    block: block,\n    className: className,\n    clearRef: clearRef,\n    disabled: disabled,\n    error: error,\n    label: valueString,\n    loading: loading,\n    placeholder: I18n.t('placeholder', {\n      scope: i18nScope\n    }),\n    onClear: internalOnClear,\n    ref: tieredSelectButtonRef,\n    tabIndex: tabIndex\n  }, valueString || I18n.t('placeholder', {\n    scope: i18nScope\n  })));\n});","map":{"version":3,"sources":["../../../../src/components/TieredSelect/LeafSelectionTieredSelect.tsx"],"names":[],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from 'react';\nimport { isEventSource } from '../../effects/ClickOutside';\nimport { useI18nContext } from '../../state/I18n';\nimport { OverlayTrigger } from '../OverlayTrigger';\nimport { Button as SelectButton } from '../Select';\nimport { TieredSelectContext } from './TieredSelect';\nimport { TieredSelectMenu } from './TieredSelectMenu';\nvar empty = [];\nvar hideKeys = {\n    overlay: ['Escape', 'Esc'],\n    target: ['Escape', 'Esc'],\n};\nexport var LeafSelectionTieredSelect = React.forwardRef(function LeafSelectionTieredSelect(_a, ref) {\n    var className = _a.className, _b = _a.disabled, disabled = _b === void 0 ? false : _b, _c = _a.error, error = _c === void 0 ? false : _c, _d = _a.loading, loading = _d === void 0 ? false : _d, onKeyDown = _a.onKeyDown, _e = _a.options, options = _e === void 0 ? empty : _e, _f = _a.value, value = _f === void 0 ? empty : _f, props = __rest(_a, [\"className\", \"disabled\", \"error\", \"loading\", \"onKeyDown\", \"options\", \"value\"]);\n    var _g = React.useContext(TieredSelectContext), afterHide = _g.afterHide, afterShow = _g.afterShow, beforeHide = _g.beforeHide, beforeShow = _g.beforeShow, block = _g.block, getGroupId = _g.getGroupId, getNextGroupId = _g.getNextGroupId, getValueString = _g.getValueString, i18nScope = _g.i18nScope, isLeaf = _g.isLeaf, onChange = _g.onChange, onClear = _g.onClear, onNavigate = _g.onNavigate, onSearch = _g.onSearch, tabIndex = _g.tabIndex;\n    var I18n = useI18nContext();\n    var tieredSelectMenuRef = React.useRef(null);\n    var tieredSelectButtonRef = React.useRef(null);\n    var clearRef = React.createRef();\n    var _h = React.useState(''), valueString = _h[0], setValueString = _h[1];\n    var _j = React.useState(null), currentTier = _j[0], setCurrentTier = _j[1];\n    // internal value used for navigation\n    var _k = React.useState(value), internalValue = _k[0], setInternalValue = _k[1];\n    // value to reset to if navigation occurs but no selection has been made\n    var _l = React.useState(value), previousValue = _l[0], setPreviousValue = _l[1];\n    // if value prop changes, update value state, current tier, and set button label\n    // else open to root\n    React.useEffect(function () {\n        var lastEntryInValue = value[value.length - 1];\n        if (value.length > 0) {\n            setInternalValue(value);\n            setPreviousValue(value);\n            setValueString(getValueString(value));\n            // show children of last tier in value if not a leaf node\n            // otherwise we want to show the parent of the last tier in value\n            if (isLeaf && !isLeaf(lastEntryInValue)) {\n                setCurrentTier(getNextGroupId(lastEntryInValue));\n            }\n            else {\n                setCurrentTier(getGroupId(lastEntryInValue));\n            }\n        }\n        else {\n            setCurrentTier(null);\n            setInternalValue([]);\n            setPreviousValue([]);\n            setValueString('');\n        }\n    }, [getGroupId, getValueString, getNextGroupId, isLeaf, value]);\n    var internalOnChange = React.useCallback(function (selection) {\n        setInternalValue(selection.value);\n        setPreviousValue(selection.value);\n        setValueString(getValueString(selection.value));\n        setCurrentTier(getGroupId(selection.item));\n        onChange(selection);\n    }, [getGroupId, onChange, getValueString]);\n    var internalOnNavigate = React.useCallback(function (nextGroupId, value) {\n        setInternalValue(value);\n        setCurrentTier(nextGroupId);\n        onNavigate && onNavigate(nextGroupId, value);\n    }, [onNavigate]);\n    var internalOnClear = React.useCallback(function (event) {\n        setValueString('');\n        setInternalValue([]);\n        setPreviousValue([]);\n        internalOnNavigate(null, []);\n        onClear && onClear(event);\n    }, [internalOnNavigate, onClear]);\n    var internalOnSearch = React.useCallback(function (event) {\n        onSearch && onSearch(event);\n    }, [onSearch]);\n    var internalBeforeHide = React.useCallback(function (e) {\n        var _a;\n        var isEscapeKey = e instanceof KeyboardEvent && (e.key === 'Escape' || e.key === 'Esc');\n        var isClickOutside = e instanceof MouseEvent &&\n            !isEventSource({ current: (_a = tieredSelectMenuRef === null || tieredSelectMenuRef === void 0 ? void 0 : tieredSelectMenuRef.current) === null || _a === void 0 ? void 0 : _a.el }, e);\n        var lastValue = previousValue[previousValue.length - 1];\n        if (valueString && (isClickOutside || isEscapeKey)) {\n            setInternalValue(previousValue);\n            if (isLeaf && isLeaf(lastValue)) {\n                setCurrentTier(getGroupId(lastValue));\n            }\n            else {\n                setCurrentTier(getNextGroupId(lastValue));\n            }\n        }\n        return beforeHide && beforeHide(e);\n    }, [\n        beforeHide,\n        getGroupId,\n        getNextGroupId,\n        isLeaf,\n        tieredSelectMenuRef,\n        previousValue,\n        valueString,\n    ]);\n    return (React.createElement(OverlayTrigger, { afterHide: afterHide, afterShow: afterShow, beforeHide: internalBeforeHide, beforeShow: function (e) {\n            return beforeShow && e.target !== clearRef.current && beforeShow(e);\n        }, canFlip: true, hideKeys: hideKeys, overlay: React.createElement(TieredSelectMenu, __assign({ currentTier: currentTier, options: options, loading: loading, menuRef: tieredSelectMenuRef, onNavigate: internalOnNavigate, onSearch: internalOnSearch, onChange: internalOnChange, value: internalValue, previousValue: previousValue }, props)), placement: \"bottom-left\", ref: ref, trigger: \"click\" },\n        React.createElement(SelectButton, { block: block, className: className, clearRef: clearRef, disabled: disabled, error: error, label: valueString, loading: loading, placeholder: I18n.t('placeholder', { scope: i18nScope }), onClear: internalOnClear, ref: tieredSelectButtonRef, tabIndex: tabIndex }, valueString || I18n.t('placeholder', { scope: i18nScope }))));\n});\n"]},"metadata":{},"sourceType":"module"}