{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport React from 'react';\nimport { MenuImperative } from '../MenuImperative';\nimport { MultiSelect } from '../MultiSelect';\nimport { StyledGroupSelectOption } from './GroupSelect.styles';\nvar emptyArray = [];\n\nvar noop = function () {};\n\nvar defaultGetId = function (item) {\n  return item.id;\n};\n\nvar defaultGetLabel = function (item) {\n  return item.label;\n};\n\nvar defaultGetGroup = function (item) {\n  return item.options;\n};\n\nvar defaultGetOptGroup = function (item) {\n  return item.groupId;\n};\n\nfunction defaultOptionRenderer(item, _a) {\n  var getId = _a.getId,\n      getLabel = _a.getLabel,\n      _b = _a.disabled,\n      disabled = _b === void 0 ? false : _b,\n      value = _a.value,\n      props = __rest(_a, [\"getId\", \"getLabel\", \"disabled\", \"value\"]);\n\n  return React.createElement(StyledGroupSelectOption, __assign({}, props, {\n    key: \"group-select-menu-item-\".concat(getId(item)),\n    value: value || item,\n    disabled: disabled\n  }), getLabel(item));\n}\n\nfunction defaultOptGroupRenderer(_a) {\n  var id = _a.id,\n      label = _a.label;\n  return React.createElement(MenuImperative.Group, {\n    key: \"group_\".concat(id),\n    clickable: false\n  }, label);\n}\n\nfunction useGroupSelect(_a) {\n  var value = _a.value,\n      options = _a.options,\n      groups = _a.groups,\n      getId = _a.getId,\n      getLabel = _a.getLabel,\n      getGroup = _a.getGroup,\n      onChange = _a.onChange,\n      _onSearch = _a.onSearch;\n\n  var _b = React.useState(''),\n      searchValue = _b[0],\n      setSearchValue = _b[1];\n\n  var groupOptionsDictionary = React.useMemo(function () {\n    return groups.reduce(function (acc, curr) {\n      var _a;\n\n      return __assign(__assign({}, acc), (_a = {}, _a[getId(curr)] = getGroup(curr), _a));\n    }, {});\n  }, [getGroup, getId, groups]);\n  var collectOptionIds = React.useCallback(function (value) {\n    return value.reduce(function (acc, cur) {\n      return acc.add(getId(cur));\n    }, new Set());\n  }, [getId]);\n  var groupIds = React.useMemo(function () {\n    return collectOptionIds(groups);\n  }, [collectOptionIds, groups]);\n\n  var isGroup = function (groupdId) {\n    return groupIds.has(groupdId);\n  };\n\n  var externalOnSearch = React.useCallback(function (e) {\n    if (_onSearch) {\n      _onSearch(e);\n    }\n  }, [_onSearch]);\n  var internalOnSearch = React.useCallback(function (e) {\n    setSearchValue(e.target.value);\n  }, []);\n  var onSearch = _onSearch ? externalOnSearch : internalOnSearch;\n  var selectedOptions = React.useMemo(function () {\n    return value.filter(function (option) {\n      return !groupIds.has(getId(option));\n    });\n  }, [getId, groupIds, value]);\n  var selectedOptionIds = React.useMemo(function () {\n    return collectOptionIds(selectedOptions);\n  }, [collectOptionIds, selectedOptions]);\n  var selectedGroups = React.useMemo(function () {\n    return groups.filter(function (group) {\n      return getGroup(group).length && getGroup(group).every(function (option) {\n        return selectedOptionIds.has(getId(option));\n      });\n    });\n  }, [getGroup, getId, groups, selectedOptionIds]);\n  var selectedGroupIds = React.useMemo(function () {\n    return collectOptionIds(selectedGroups);\n  }, [collectOptionIds, selectedGroups]);\n\n  var getGroupOptions = function (groupOptiodId) {\n    var groupOptions = groupOptionsDictionary[groupOptiodId] || [];\n    return groupOptions.filter(function (groupOption) {\n      return !selectedOptionIds.has(getId(groupOption));\n    });\n  };\n\n  var onSelect = function (selection) {\n    var newSelected = selection.reduce(function (acc, option) {\n      var optionId = getId(option);\n\n      if (isGroup(optionId)) {\n        return !selectedGroupIds.has(optionId) ? __spreadArray(__spreadArray([], acc, true), getGroupOptions(optionId), true) : acc;\n      }\n\n      return __spreadArray(__spreadArray([], acc, true), [option], false);\n    }, []);\n    setSearchValue('');\n    onChange(newSelected);\n  };\n\n  var searchFilterCallback = React.useCallback(function (option) {\n    return getLabel(option).toLowerCase().includes(searchValue.toLowerCase());\n  }, [getLabel, searchValue]);\n  var computedOptions = _onSearch ? options : options.filter(searchFilterCallback);\n  var filteredGroups = _onSearch ? groups : groups.filter(searchFilterCallback);\n  var computedGroups = React.useMemo(function () {\n    return filteredGroups.filter(function (group) {\n      return getGroup(group).length;\n    });\n  }, [filteredGroups, getGroup]);\n  return {\n    selectedOptions: selectedOptions,\n    computedOptions: __spreadArray(__spreadArray([], computedGroups, true), computedOptions, true),\n    selectedOptionIds: selectedOptionIds,\n    selectedGroupIds: selectedGroupIds,\n    isGroup: isGroup,\n    onSearch: onSearch,\n    onSelect: onSelect\n  };\n}\n\nexport var GroupSelect = React.forwardRef(function GroupSelect(_a, ref) {\n  var _b = _a.value,\n      value = _b === void 0 ? emptyArray : _b,\n      _c = _a.options,\n      options = _c === void 0 ? emptyArray : _c,\n      _d = _a.groups,\n      groups = _d === void 0 ? emptyArray : _d,\n      _e = _a.getId,\n      getId = _e === void 0 ? defaultGetId : _e,\n      _f = _a.getLabel,\n      getLabel = _f === void 0 ? defaultGetLabel : _f,\n      _g = _a.getGroup,\n      getGroup = _g === void 0 ? defaultGetGroup : _g,\n      _h = _a.getOptGroup,\n      getOptGroup = _h === void 0 ? defaultGetOptGroup : _h,\n      _j = _a.onChange,\n      onChange = _j === void 0 ? noop : _j,\n      _onSearch = _a.onSearch,\n      optionRenderer = _a.optionRenderer,\n      groupRenderer = _a.groupRenderer,\n      _k = _a.optGroupRenderer,\n      optGroupRenderer = _k === void 0 ? defaultOptGroupRenderer : _k,\n      props = __rest(_a, [\"value\", \"options\", \"groups\", \"getId\", \"getLabel\", \"getGroup\", \"getOptGroup\", \"onChange\", \"onSearch\", \"optionRenderer\", \"groupRenderer\", \"optGroupRenderer\"]);\n\n  var _l = useGroupSelect({\n    value: value,\n    options: options,\n    groups: groups,\n    getId: getId,\n    getLabel: getLabel,\n    getGroup: getGroup,\n    onChange: onChange,\n    onSearch: _onSearch\n  }),\n      selectedOptions = _l.selectedOptions,\n      selectedOptionIds = _l.selectedOptionIds,\n      selectedGroupIds = _l.selectedGroupIds,\n      computedOptions = _l.computedOptions,\n      isGroup = _l.isGroup,\n      onSelect = _l.onSelect,\n      onSearch = _l.onSearch;\n\n  var multiselectOptionRenderer = React.useCallback(function (option) {\n    var optionId = getId(option);\n    var renderer = (isGroup(optionId) ? groupRenderer : optionRenderer) || defaultOptionRenderer;\n    var isSelected = selectedOptionIds.has(optionId);\n    var isDisabled = selectedGroupIds.has(optionId);\n    return renderer(option, {\n      getId: getId,\n      getLabel: getLabel,\n      value: option,\n      selected: isSelected,\n      disabled: isDisabled\n    });\n  }, [getId, getLabel, groupRenderer, isGroup, optionRenderer, selectedGroupIds, selectedOptionIds]);\n  return React.createElement(MultiSelect, __assign({\n    ref: ref\n  }, props, {\n    value: selectedOptions,\n    options: computedOptions,\n    getId: getId,\n    getLabel: getLabel,\n    onChange: onSelect,\n    onSearch: onSearch,\n    getGroup: getOptGroup,\n    optionRenderer: multiselectOptionRenderer,\n    groupHeaderRenderer: optGroupRenderer\n  }));\n});\nGroupSelect.displayName = 'GroupSelect';","map":{"version":3,"sources":["../../../../src/components/GroupSelect/GroupSelect.tsx"],"names":[],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport React from 'react';\nimport { MenuImperative } from '../MenuImperative';\nimport { MultiSelect } from '../MultiSelect';\nimport { StyledGroupSelectOption } from './GroupSelect.styles';\nvar emptyArray = [];\nvar noop = function () { };\nvar defaultGetId = function (item) { return item.id; };\nvar defaultGetLabel = function (item) { return item.label; };\nvar defaultGetGroup = function (item) { return item.options; };\nvar defaultGetOptGroup = function (item) {\n    return item.groupId;\n};\nfunction defaultOptionRenderer(item, _a) {\n    var getId = _a.getId, getLabel = _a.getLabel, _b = _a.disabled, disabled = _b === void 0 ? false : _b, value = _a.value, props = __rest(_a, [\"getId\", \"getLabel\", \"disabled\", \"value\"]);\n    return (React.createElement(StyledGroupSelectOption, __assign({}, props, { key: \"group-select-menu-item-\".concat(getId(item)), value: value || item, disabled: disabled }), getLabel(item)));\n}\nfunction defaultOptGroupRenderer(_a) {\n    var id = _a.id, label = _a.label;\n    return (React.createElement(MenuImperative.Group, { key: \"group_\".concat(id), clickable: false }, label));\n}\nfunction useGroupSelect(_a) {\n    var value = _a.value, options = _a.options, groups = _a.groups, getId = _a.getId, getLabel = _a.getLabel, getGroup = _a.getGroup, onChange = _a.onChange, _onSearch = _a.onSearch;\n    var _b = React.useState(''), searchValue = _b[0], setSearchValue = _b[1];\n    var groupOptionsDictionary = React.useMemo(function () {\n        return groups.reduce(function (acc, curr) {\n            var _a;\n            return (__assign(__assign({}, acc), (_a = {}, _a[getId(curr)] = getGroup(curr), _a)));\n        }, {});\n    }, [getGroup, getId, groups]);\n    var collectOptionIds = React.useCallback(function (value) {\n        return value.reduce(function (acc, cur) { return acc.add(getId(cur)); }, new Set());\n    }, [getId]);\n    var groupIds = React.useMemo(function () { return collectOptionIds(groups); }, [collectOptionIds, groups]);\n    var isGroup = function (groupdId) { return groupIds.has(groupdId); };\n    var externalOnSearch = React.useCallback(function (e) {\n        if (_onSearch) {\n            _onSearch(e);\n        }\n    }, [_onSearch]);\n    var internalOnSearch = React.useCallback(function (e) {\n        setSearchValue(e.target.value);\n    }, []);\n    var onSearch = _onSearch ? externalOnSearch : internalOnSearch;\n    var selectedOptions = React.useMemo(function () { return value.filter(function (option) { return !groupIds.has(getId(option)); }); }, [getId, groupIds, value]);\n    var selectedOptionIds = React.useMemo(function () { return collectOptionIds(selectedOptions); }, [collectOptionIds, selectedOptions]);\n    var selectedGroups = React.useMemo(function () {\n        return groups.filter(function (group) {\n            return getGroup(group).length &&\n                getGroup(group).every(function (option) {\n                    return selectedOptionIds.has(getId(option));\n                });\n        });\n    }, [getGroup, getId, groups, selectedOptionIds]);\n    var selectedGroupIds = React.useMemo(function () { return collectOptionIds(selectedGroups); }, [collectOptionIds, selectedGroups]);\n    var getGroupOptions = function (groupOptiodId) {\n        var groupOptions = groupOptionsDictionary[groupOptiodId] || [];\n        return groupOptions.filter(function (groupOption) { return !selectedOptionIds.has(getId(groupOption)); });\n    };\n    var onSelect = function (selection) {\n        var newSelected = selection.reduce(function (acc, option) {\n            var optionId = getId(option);\n            if (isGroup(optionId)) {\n                return !selectedGroupIds.has(optionId)\n                    ? __spreadArray(__spreadArray([], acc, true), getGroupOptions(optionId), true) : acc;\n            }\n            return __spreadArray(__spreadArray([], acc, true), [option], false);\n        }, []);\n        setSearchValue('');\n        onChange(newSelected);\n    };\n    var searchFilterCallback = React.useCallback(function (option) {\n        return getLabel(option).toLowerCase().includes(searchValue.toLowerCase());\n    }, [getLabel, searchValue]);\n    var computedOptions = _onSearch\n        ? options\n        : options.filter(searchFilterCallback);\n    var filteredGroups = _onSearch\n        ? groups\n        : groups.filter(searchFilterCallback);\n    var computedGroups = React.useMemo(function () { return filteredGroups.filter(function (group) { return getGroup(group).length; }); }, [filteredGroups, getGroup]);\n    return {\n        selectedOptions: selectedOptions,\n        computedOptions: __spreadArray(__spreadArray([], computedGroups, true), computedOptions, true),\n        selectedOptionIds: selectedOptionIds,\n        selectedGroupIds: selectedGroupIds,\n        isGroup: isGroup,\n        onSearch: onSearch,\n        onSelect: onSelect,\n    };\n}\nexport var GroupSelect = React.forwardRef(function GroupSelect(_a, ref) {\n    var _b = _a.value, value = _b === void 0 ? emptyArray : _b, _c = _a.options, options = _c === void 0 ? emptyArray : _c, _d = _a.groups, groups = _d === void 0 ? emptyArray : _d, _e = _a.getId, getId = _e === void 0 ? defaultGetId : _e, _f = _a.getLabel, getLabel = _f === void 0 ? defaultGetLabel : _f, _g = _a.getGroup, getGroup = _g === void 0 ? defaultGetGroup : _g, _h = _a.getOptGroup, getOptGroup = _h === void 0 ? defaultGetOptGroup : _h, _j = _a.onChange, onChange = _j === void 0 ? noop : _j, _onSearch = _a.onSearch, optionRenderer = _a.optionRenderer, groupRenderer = _a.groupRenderer, _k = _a.optGroupRenderer, optGroupRenderer = _k === void 0 ? defaultOptGroupRenderer : _k, props = __rest(_a, [\"value\", \"options\", \"groups\", \"getId\", \"getLabel\", \"getGroup\", \"getOptGroup\", \"onChange\", \"onSearch\", \"optionRenderer\", \"groupRenderer\", \"optGroupRenderer\"]);\n    var _l = useGroupSelect({\n        value: value,\n        options: options,\n        groups: groups,\n        getId: getId,\n        getLabel: getLabel,\n        getGroup: getGroup,\n        onChange: onChange,\n        onSearch: _onSearch,\n    }), selectedOptions = _l.selectedOptions, selectedOptionIds = _l.selectedOptionIds, selectedGroupIds = _l.selectedGroupIds, computedOptions = _l.computedOptions, isGroup = _l.isGroup, onSelect = _l.onSelect, onSearch = _l.onSearch;\n    var multiselectOptionRenderer = React.useCallback(function (option) {\n        var optionId = getId(option);\n        var renderer = (isGroup(optionId) ? groupRenderer : optionRenderer) ||\n            defaultOptionRenderer;\n        var isSelected = selectedOptionIds.has(optionId);\n        var isDisabled = selectedGroupIds.has(optionId);\n        return renderer(option, {\n            getId: getId,\n            getLabel: getLabel,\n            value: option,\n            selected: isSelected,\n            disabled: isDisabled,\n        });\n    }, [\n        getId,\n        getLabel,\n        groupRenderer,\n        isGroup,\n        optionRenderer,\n        selectedGroupIds,\n        selectedOptionIds,\n    ]);\n    return (React.createElement(MultiSelect, __assign({ ref: ref }, props, { value: selectedOptions, options: computedOptions, getId: getId, getLabel: getLabel, onChange: onSelect, onSearch: onSearch, getGroup: getOptGroup, optionRenderer: multiselectOptionRenderer, groupHeaderRenderer: optGroupRenderer })));\n});\nGroupSelect.displayName = 'GroupSelect';\n"]},"metadata":{},"sourceType":"module"}