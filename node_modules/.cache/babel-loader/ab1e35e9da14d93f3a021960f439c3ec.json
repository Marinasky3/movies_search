{"ast":null,"code":"var __makeTemplateObject = this && this.__makeTemplateObject || function (cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n};\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar _a;\n\nimport { Ban, Image } from '@procore/core-icons/dist';\nimport { equals, omit } from 'ramda';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { useResizeObserver } from '../../effects/ResizeObserver';\nimport { useFocusWithin } from '../../effects/useFocusWithin';\nimport { useI18nContext } from '../../state/I18n';\nimport { Banner } from '../Banner';\nimport { Button } from '../Button';\nimport { Tooltip } from '../Tooltip';\nimport { Typography } from '../Typography/Typography';\nimport { StyledDropzoneCaption, StyledDropzoneContainer, StyledDropzoneFocusDetector, StyledDropzoneIcon, StyledDropzoneMessage, StyledDropzoneWrapper, StyledErrorBanner, StyledErrorBannerDetails, StyledUploadButton } from './Dropzone.styles';\nimport { dropErrors, fileRejectionReason } from './Dropzone.types';\nvar extendedViewHeightBreakpoint = 172;\nvar DropzoneErrorBannerBase = React.forwardRef(function (_a, ref) {\n  var error = _a.error,\n      onDismiss = _a.onDismiss,\n      qa = _a.qa,\n      props = __rest(_a, [\"error\", \"onDismiss\", \"qa\"]);\n\n  var I18n = useI18nContext();\n\n  var _b = React.useState(false),\n      isExpanded = _b[0],\n      setExpanded = _b[1];\n\n  React.useEffect(function () {\n    setExpanded(false);\n  }, [error.title, error.body, error.message]);\n\n  if (error.type === dropErrors.reset) {\n    return null;\n  }\n\n  return React.createElement(StyledErrorBanner, __assign({}, props, {\n    ref: ref\n  }), React.createElement(Banner.Content, null, React.createElement(Banner.Title, null, error.title), React.createElement(Banner.Body, null, error.message)), error.body ? React.createElement(Banner.Action, null, React.createElement(Button, {\n    \"data-qa\": qa === null || qa === void 0 ? void 0 : qa.showErrorDetails,\n    onClick: function () {\n      return setExpanded(function (prev) {\n        return !prev;\n      });\n    }\n  }, isExpanded ? I18n.t('core.dropzone.hideDetails') : I18n.t('core.dropzone.showDetails'))) : null, React.createElement(Banner.Dismiss, {\n    onClick: onDismiss,\n    \"data-qa\": qa === null || qa === void 0 ? void 0 : qa.hideError\n  }), error.body ? React.createElement(Banner.ExpandableContent, {\n    expanded: isExpanded\n  }, error.body) : null);\n});\nexport function MultipleErrors(props) {\n  var _a, _b;\n\n  var I18n = useI18nContext();\n  var filesByErrorType = props.fileRejections.reduce(function (acc, rejection) {\n    rejection.errors.forEach(function (error) {\n      var dropErrorType = dropErrorsByReason[error.code];\n      acc[dropErrorType].push(rejection.file);\n    });\n    return acc;\n  }, (_a = {}, _a[dropErrors.fileAmount] = [], _a[dropErrors.minFileSize] = [], _a[dropErrors.maxFileSize] = [], _a[dropErrors.fileType] = [], _a[dropErrors.oneFileAtATime] = [], _a[dropErrors.reset] = [], _a[dropErrors.multipleErrors] = [], _a));\n  var messages = (_b = {}, _b[dropErrors.fileAmount] = I18n.t('core.dropzone.maxFileNumberErrorGroup', {\n    count: props.maxFiles\n  }), _b[dropErrors.minFileSize] = I18n.t('core.dropzone.minFileSizeErrorGroup', {\n    sizeInMegabytes: getSizeInMB(props.minSize)\n  }), _b[dropErrors.maxFileSize] = I18n.t('core.dropzone.maxFileSizeErrorGroup', {\n    sizeInMegabytes: getSizeInMB(props.maxSize)\n  }), _b[dropErrors.fileType] = I18n.t('core.dropzone.wrongFileTypeErrorGroup'), _b[dropErrors.reset] = '', _b[dropErrors.multipleErrors] = '', _b[dropErrors.oneFileAtATime] = '', _b);\n  return React.createElement(\"div\", null, [dropErrors.fileAmount, dropErrors.fileType, dropErrors.maxFileSize, dropErrors.minFileSize].map(function (errorType) {\n    var files = filesByErrorType[errorType];\n    return files.length ? React.createElement(\"div\", {\n      key: errorType\n    }, React.createElement(Typography, {\n      weight: \"bold\"\n    }, messages[errorType]), React.createElement(StyledErrorBannerDetails, null, filesByErrorType[errorType].map(function (_a) {\n      var name = _a.name;\n      return React.createElement(\"li\", {\n        key: name\n      }, name);\n    }))) : null;\n  }));\n} // make error banner accessible as a styled-components selector\n\nexport var DropzoneErrorBanner = styled(DropzoneErrorBannerBase)(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\"], [\"\"])));\n\nfunction DropzoneContainer(_a) {\n  var active = _a.active,\n      disabled = _a.disabled,\n      getRootProps = _a.getRootProps,\n      rootProps = _a.rootProps,\n      children = _a.children;\n  return React.createElement(StyledDropzoneContainer, __assign({}, getRootProps(rootProps), {\n    active: active,\n    disabled: disabled\n  }), children);\n}\n\nfunction DropzoneContent(_a) {\n  var disabled = _a.disabled,\n      isIconVisible = _a.isIconVisible,\n      contentMessage = _a.contentMessage;\n  return React.createElement(StyledDropzoneMessage, null, isIconVisible && React.createElement(StyledDropzoneIcon, {\n    disabled: disabled\n  }, disabled ? React.createElement(Ban, null) : React.createElement(Image, null)), contentMessage);\n}\n\nexport function DefaultMessage(_a) {\n  var open = _a.open,\n      disabled = _a.disabled,\n      multiple = _a.multiple,\n      errorMessage = _a.errorMessage;\n  var I18n = useI18nContext();\n  return React.createElement(React.Fragment, null, React.createElement(StyledUploadButton, {\n    variant: \"secondary\",\n    onClick: open,\n    disabled: disabled\n  }, I18n.t('core.dropzone.uploadFiles', {\n    count: multiple ? Infinity : 1\n  })), React.createElement(StyledDropzoneCaption, {\n    error: !!errorMessage\n  }, errorMessage || I18n.t('core.dropzone.dragAndDrop')));\n}\nvar dropErrorsByReason = (_a = {}, _a[fileRejectionReason.maxFiles] = dropErrors.fileAmount, _a[fileRejectionReason.maxFileSize] = dropErrors.maxFileSize, _a[fileRejectionReason.minFileSize] = dropErrors.minFileSize, _a[fileRejectionReason.fileType] = dropErrors.fileType, _a);\n\nvar getSizeInMB = function (maxSize) {\n  return maxSize / 10e5;\n};\n\nvar Dropzone_ = React.forwardRef(function Dropzone(_a, ref) {\n  var forceIconVisibility = _a.isIconVisible,\n      contentRenderer = _a.contentRenderer,\n      disabled = _a.disabled,\n      tooltip = _a.tooltip,\n      rootRef = _a.rootRef,\n      inputRef = _a.inputRef,\n      dragError = _a.dragError,\n      dropError = _a.dropError,\n      dispatchDropError = _a.dispatchDropError,\n      getRootProps = _a.getRootProps,\n      getInputProps = _a.getInputProps,\n      isDragActive = _a.isDragActive,\n      multiple = _a.multiple,\n      fileRejections = _a.fileRejections,\n      open = _a.open,\n      _b = _a.rootProps,\n      rootProps = _b === void 0 ? {} : _b,\n      _c = _a.inputProps,\n      inputProps = _c === void 0 ? {} : _c,\n      className = _a.className,\n      qa = _a.qa;\n\n  var _d = React.useState(false),\n      isIconVisible = _d[0],\n      setIsIconVisible = _d[1];\n\n  var _e = useFocusWithin(),\n      isFocusWithin = _e.isFocusWithin,\n      containerProps = _e.containerProps;\n\n  var toggleIconVisibility = React.useCallback(function (entries) {\n    var height = entries[0].target.offsetHeight;\n    setIsIconVisible(height >= extendedViewHeightBreakpoint);\n  }, [setIsIconVisible]);\n  var setResizeObserverTarget = useResizeObserver(toggleIconVisibility);\n  React.useEffect(function () {\n    setResizeObserverTarget(rootRef.current);\n  }, [rootRef, setResizeObserverTarget]);\n  React.useImperativeHandle(ref, function () {\n    return {\n      rootRef: rootRef,\n      inputRef: inputRef,\n      open: open\n    };\n  });\n  var isDropzoneDisabled = disabled || Boolean(dragError);\n  var contentMessage = React.useMemo(function () {\n    return contentRenderer ? contentRenderer({\n      open: open,\n      disabled: isDropzoneDisabled,\n      errorMessage: dragError\n    }) : React.createElement(DefaultMessage, {\n      open: open,\n      disabled: isDropzoneDisabled,\n      errorMessage: dragError,\n      multiple: multiple\n    });\n  }, [contentRenderer, open, isDropzoneDisabled, dragError, multiple]);\n  var validRootProps = React.useMemo(function () {\n    return omit(['disabled'], rootProps);\n  }, [rootProps]);\n  var validInputProps = React.useMemo(function () {\n    return omit(['accept', 'multiple', 'type'], inputProps);\n  }, [inputProps]);\n  return React.createElement(StyledDropzoneWrapper, {\n    direction: \"column\",\n    alignItems: \"stretch\",\n    className: className\n  }, React.createElement(Tooltip, {\n    trigger: Boolean(tooltip) ? 'hover' : 'none',\n    overlay: tooltip || ''\n  }, React.createElement(StyledDropzoneFocusDetector, __assign({}, containerProps), React.createElement(DropzoneContainer, {\n    rootProps: validRootProps,\n    active: isDragActive || isFocusWithin,\n    disabled: isDropzoneDisabled,\n    getRootProps: getRootProps\n  }, React.createElement(\"input\", __assign({\n    type: \"file\"\n  }, getInputProps(validInputProps))), React.createElement(DropzoneContent, {\n    disabled: isDropzoneDisabled,\n    isIconVisible: typeof forceIconVisibility === 'undefined' ? isIconVisible : forceIconVisibility,\n    contentMessage: contentMessage\n  })))), React.createElement(DropzoneErrorBanner, {\n    qa: qa,\n    error: dropError,\n    fileRejections: fileRejections,\n    onDismiss: function () {\n      return dispatchDropError(dropErrors.reset);\n    }\n  }));\n});\nDropzoneContainer.displayName = 'DropzoneContainer';\nDropzoneContent.displayName = 'DropzoneContent';\nDropzone_.displayName = 'Dropzone';\nexport var Dropzone = React.memo(Dropzone_, equals);\nvar templateObject_1;","map":{"version":3,"sources":["../../../../src/components/Dropzone/Dropzone.tsx"],"names":[],"mappings":"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","sourcesContent":["var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar _a;\nimport { Ban, Image } from '@procore/core-icons/dist';\nimport { equals, omit } from 'ramda';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { useResizeObserver } from '../../effects/ResizeObserver';\nimport { useFocusWithin } from '../../effects/useFocusWithin';\nimport { useI18nContext } from '../../state/I18n';\nimport { Banner } from '../Banner';\nimport { Button } from '../Button';\nimport { Tooltip } from '../Tooltip';\nimport { Typography } from '../Typography/Typography';\nimport { StyledDropzoneCaption, StyledDropzoneContainer, StyledDropzoneFocusDetector, StyledDropzoneIcon, StyledDropzoneMessage, StyledDropzoneWrapper, StyledErrorBanner, StyledErrorBannerDetails, StyledUploadButton, } from './Dropzone.styles';\nimport { dropErrors, fileRejectionReason, } from './Dropzone.types';\nvar extendedViewHeightBreakpoint = 172;\nvar DropzoneErrorBannerBase = React.forwardRef(function (_a, ref) {\n    var error = _a.error, onDismiss = _a.onDismiss, qa = _a.qa, props = __rest(_a, [\"error\", \"onDismiss\", \"qa\"]);\n    var I18n = useI18nContext();\n    var _b = React.useState(false), isExpanded = _b[0], setExpanded = _b[1];\n    React.useEffect(function () {\n        setExpanded(false);\n    }, [error.title, error.body, error.message]);\n    if (error.type === dropErrors.reset) {\n        return null;\n    }\n    return (React.createElement(StyledErrorBanner, __assign({}, props, { ref: ref }),\n        React.createElement(Banner.Content, null,\n            React.createElement(Banner.Title, null, error.title),\n            React.createElement(Banner.Body, null, error.message)),\n        error.body ? (React.createElement(Banner.Action, null,\n            React.createElement(Button, { \"data-qa\": qa === null || qa === void 0 ? void 0 : qa.showErrorDetails, onClick: function () { return setExpanded(function (prev) { return !prev; }); } }, isExpanded\n                ? I18n.t('core.dropzone.hideDetails')\n                : I18n.t('core.dropzone.showDetails')))) : null,\n        React.createElement(Banner.Dismiss, { onClick: onDismiss, \"data-qa\": qa === null || qa === void 0 ? void 0 : qa.hideError }),\n        error.body ? (React.createElement(Banner.ExpandableContent, { expanded: isExpanded }, error.body)) : null));\n});\nexport function MultipleErrors(props) {\n    var _a, _b;\n    var I18n = useI18nContext();\n    var filesByErrorType = props.fileRejections.reduce(function (acc, rejection) {\n        rejection.errors.forEach(function (error) {\n            var dropErrorType = dropErrorsByReason[error.code];\n            acc[dropErrorType].push(rejection.file);\n        });\n        return acc;\n    }, (_a = {},\n        _a[dropErrors.fileAmount] = [],\n        _a[dropErrors.minFileSize] = [],\n        _a[dropErrors.maxFileSize] = [],\n        _a[dropErrors.fileType] = [],\n        _a[dropErrors.oneFileAtATime] = [],\n        _a[dropErrors.reset] = [],\n        _a[dropErrors.multipleErrors] = [],\n        _a));\n    var messages = (_b = {},\n        _b[dropErrors.fileAmount] = I18n.t('core.dropzone.maxFileNumberErrorGroup', {\n            count: props.maxFiles,\n        }),\n        _b[dropErrors.minFileSize] = I18n.t('core.dropzone.minFileSizeErrorGroup', {\n            sizeInMegabytes: getSizeInMB(props.minSize),\n        }),\n        _b[dropErrors.maxFileSize] = I18n.t('core.dropzone.maxFileSizeErrorGroup', {\n            sizeInMegabytes: getSizeInMB(props.maxSize),\n        }),\n        _b[dropErrors.fileType] = I18n.t('core.dropzone.wrongFileTypeErrorGroup'),\n        _b[dropErrors.reset] = '',\n        _b[dropErrors.multipleErrors] = '',\n        _b[dropErrors.oneFileAtATime] = '',\n        _b);\n    return (React.createElement(\"div\", null, [\n        dropErrors.fileAmount,\n        dropErrors.fileType,\n        dropErrors.maxFileSize,\n        dropErrors.minFileSize,\n    ].map(function (errorType) {\n        var files = filesByErrorType[errorType];\n        return files.length ? (React.createElement(\"div\", { key: errorType },\n            React.createElement(Typography, { weight: \"bold\" }, messages[errorType]),\n            React.createElement(StyledErrorBannerDetails, null, filesByErrorType[errorType].map(function (_a) {\n                var name = _a.name;\n                return (React.createElement(\"li\", { key: name }, name));\n            })))) : null;\n    })));\n}\n// make error banner accessible as a styled-components selector\nexport var DropzoneErrorBanner = styled(DropzoneErrorBannerBase)(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\"], [\"\"])));\nfunction DropzoneContainer(_a) {\n    var active = _a.active, disabled = _a.disabled, getRootProps = _a.getRootProps, rootProps = _a.rootProps, children = _a.children;\n    return (React.createElement(StyledDropzoneContainer, __assign({}, getRootProps(rootProps), { active: active, disabled: disabled }), children));\n}\nfunction DropzoneContent(_a) {\n    var disabled = _a.disabled, isIconVisible = _a.isIconVisible, contentMessage = _a.contentMessage;\n    return (React.createElement(StyledDropzoneMessage, null,\n        isIconVisible && (React.createElement(StyledDropzoneIcon, { disabled: disabled }, disabled ? React.createElement(Ban, null) : React.createElement(Image, null))),\n        contentMessage));\n}\nexport function DefaultMessage(_a) {\n    var open = _a.open, disabled = _a.disabled, multiple = _a.multiple, errorMessage = _a.errorMessage;\n    var I18n = useI18nContext();\n    return (React.createElement(React.Fragment, null,\n        React.createElement(StyledUploadButton, { variant: \"secondary\", onClick: open, disabled: disabled }, I18n.t('core.dropzone.uploadFiles', {\n            count: multiple ? Infinity : 1,\n        })),\n        React.createElement(StyledDropzoneCaption, { error: !!errorMessage }, errorMessage || I18n.t('core.dropzone.dragAndDrop'))));\n}\nvar dropErrorsByReason = (_a = {},\n    _a[fileRejectionReason.maxFiles] = dropErrors.fileAmount,\n    _a[fileRejectionReason.maxFileSize] = dropErrors.maxFileSize,\n    _a[fileRejectionReason.minFileSize] = dropErrors.minFileSize,\n    _a[fileRejectionReason.fileType] = dropErrors.fileType,\n    _a);\nvar getSizeInMB = function (maxSize) { return maxSize / 10e5; };\nvar Dropzone_ = React.forwardRef(function Dropzone(_a, ref) {\n    var forceIconVisibility = _a.isIconVisible, contentRenderer = _a.contentRenderer, disabled = _a.disabled, tooltip = _a.tooltip, rootRef = _a.rootRef, inputRef = _a.inputRef, dragError = _a.dragError, dropError = _a.dropError, dispatchDropError = _a.dispatchDropError, getRootProps = _a.getRootProps, getInputProps = _a.getInputProps, isDragActive = _a.isDragActive, multiple = _a.multiple, fileRejections = _a.fileRejections, open = _a.open, _b = _a.rootProps, rootProps = _b === void 0 ? {} : _b, _c = _a.inputProps, inputProps = _c === void 0 ? {} : _c, className = _a.className, qa = _a.qa;\n    var _d = React.useState(false), isIconVisible = _d[0], setIsIconVisible = _d[1];\n    var _e = useFocusWithin(), isFocusWithin = _e.isFocusWithin, containerProps = _e.containerProps;\n    var toggleIconVisibility = React.useCallback(function (entries) {\n        var height = entries[0].target.offsetHeight;\n        setIsIconVisible(height >= extendedViewHeightBreakpoint);\n    }, [setIsIconVisible]);\n    var setResizeObserverTarget = useResizeObserver(toggleIconVisibility);\n    React.useEffect(function () {\n        setResizeObserverTarget(rootRef.current);\n    }, [rootRef, setResizeObserverTarget]);\n    React.useImperativeHandle(ref, function () { return ({\n        rootRef: rootRef,\n        inputRef: inputRef,\n        open: open,\n    }); });\n    var isDropzoneDisabled = disabled || Boolean(dragError);\n    var contentMessage = React.useMemo(function () {\n        return contentRenderer ? (contentRenderer({\n            open: open,\n            disabled: isDropzoneDisabled,\n            errorMessage: dragError,\n        })) : (React.createElement(DefaultMessage, { open: open, disabled: isDropzoneDisabled, errorMessage: dragError, multiple: multiple }));\n    }, [contentRenderer, open, isDropzoneDisabled, dragError, multiple]);\n    var validRootProps = React.useMemo(function () { return omit(['disabled'], rootProps); }, [rootProps]);\n    var validInputProps = React.useMemo(function () { return omit(['accept', 'multiple', 'type'], inputProps); }, [inputProps]);\n    return (React.createElement(StyledDropzoneWrapper, { direction: \"column\", alignItems: \"stretch\", className: className },\n        React.createElement(Tooltip, { trigger: Boolean(tooltip) ? 'hover' : 'none', overlay: tooltip || '' },\n            React.createElement(StyledDropzoneFocusDetector, __assign({}, containerProps),\n                React.createElement(DropzoneContainer, { rootProps: validRootProps, active: isDragActive || isFocusWithin, disabled: isDropzoneDisabled, getRootProps: getRootProps },\n                    React.createElement(\"input\", __assign({ type: \"file\" }, getInputProps(validInputProps))),\n                    React.createElement(DropzoneContent, { disabled: isDropzoneDisabled, isIconVisible: typeof forceIconVisibility === 'undefined'\n                            ? isIconVisible\n                            : forceIconVisibility, contentMessage: contentMessage })))),\n        React.createElement(DropzoneErrorBanner, { qa: qa, error: dropError, fileRejections: fileRejections, onDismiss: function () { return dispatchDropError(dropErrors.reset); } })));\n});\nDropzoneContainer.displayName = 'DropzoneContainer';\nDropzoneContent.displayName = 'DropzoneContent';\nDropzone_.displayName = 'Dropzone';\nexport var Dropzone = React.memo(Dropzone_, equals);\nvar templateObject_1;\n"]},"metadata":{},"sourceType":"module"}