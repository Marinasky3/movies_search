{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { EllipsisVertical } from '@procore/core-icons/dist';\nimport React from 'react';\nimport { useClickOutside } from '../../effects/ClickOutside';\nimport { Trigger } from '../../state/Trigger';\nimport { Card } from '../Card';\nimport { DropdownButton } from '../Dropdown';\nimport { Overlay } from '../Overlay';\nimport { StyledDropdownFlyout, StyledDropdownFlyoutItem } from './DropdownFlyout.styles';\nimport { rootId } from './DropdownFlyout.types';\nimport { defaultOptionRenderer, noop, useDropdownFlyout, transformOption, DropdownFlyoutContext, useDropdownFlyoutContext } from './DropdownFlyout.helpers';\nexport var FlyoutCaption = React.forwardRef(function FlyoutCaption(_a, ref) {\n  var option = _a.option,\n      highlighted = _a.highlighted,\n      optionRenderer = _a.optionRenderer,\n      props = __rest(_a, [\"option\", \"highlighted\", \"optionRenderer\"]);\n\n  return React.createElement(StyledDropdownFlyoutItem, __assign({}, props, {\n    ref: ref,\n    \"data-highlighted\": highlighted\n  }), optionRenderer(option));\n});\nFlyoutCaption.displayName = 'FlyoutCaption';\nexport function FlyoutItem(_a) {\n  var option = _a.option,\n      container = _a.container,\n      placement = _a.placement;\n  var captionRef = React.useRef(null);\n  var overlayRef = React.useRef(null);\n\n  var _b = useDropdownFlyoutContext(),\n      isHighlighted = _b.isHighlighted,\n      isExpanded = _b.isExpanded,\n      _onClick = _b.onClick,\n      expand = _b.expand,\n      collapse = _b.collapse,\n      optionRenderer = _b.optionRenderer;\n\n  var onMouseEnter = React.useCallback(function () {\n    return expand(option);\n  }, [option, expand]);\n  var onMouseLeave = React.useCallback(function (e) {\n    var _a;\n\n    if (e.relatedTarget instanceof Node && !((_a = overlayRef.current) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n      collapse(option);\n    }\n  }, [collapse, option]);\n  var onClick = React.useCallback(function () {\n    return _onClick(option);\n  }, [_onClick, option]);\n  return React.createElement(React.Fragment, null, React.createElement(FlyoutCaption, {\n    ref: captionRef,\n    option: option.origin,\n    onClick: onClick,\n    optionRenderer: optionRenderer,\n    highlighted: isHighlighted(option),\n    onMouseEnter: onMouseEnter,\n    onMouseLeave: onMouseLeave\n  }), Array.isArray(option.children) && isExpanded(option) ? React.createElement(FlyoutList, {\n    options: option.children,\n    overlayRef: overlayRef,\n    targetRef: captionRef,\n    container: container,\n    placement: placement\n  }) : null);\n}\nexport function FlyoutList(_a) {\n  var options = _a.options,\n      targetRef = _a.targetRef,\n      ref = _a.overlayRef,\n      container = _a.container,\n      placement = _a.placement,\n      props = __rest(_a, [\"options\", \"targetRef\", \"overlayRef\", \"container\", \"placement\"]);\n\n  var overlayRef = React.useRef(null);\n  return React.createElement(Overlay, __assign({}, __assign({\n    ref: ref,\n    overlayRef: overlayRef,\n    targetRef: targetRef,\n    placement: placement,\n    container: container,\n    padding: 0\n  }, props)), React.createElement(Card, {\n    shadowStrength: 2\n  }, React.createElement(StyledDropdownFlyout, null, options.map(function (option) {\n    return React.createElement(FlyoutItem, {\n      key: option.id,\n      option: option,\n      container: container,\n      placement: placement\n    });\n  }))));\n}\nvar DefaultButton = React.forwardRef(function DefaultButton(_a, ref) {\n  var children = _a.children,\n      icon = _a.icon,\n      props = __rest(_a, [\"children\", \"icon\"]);\n\n  return React.createElement(DropdownButton, __assign({}, props, {\n    icon: props.loading ? undefined : !icon && !children ? React.createElement(EllipsisVertical, null) : icon,\n    arrow: !children ? false : true,\n    ref: ref\n  }), children);\n});\nexport var DropdownFlyout = React.forwardRef(function DropdownFlyout(_a, ref) {\n  var disabled = _a.disabled,\n      icon = _a.icon,\n      label = _a.label,\n      loading = _a.loading,\n      _options = _a.options,\n      _b = _a.onClick,\n      _onClick = _b === void 0 ? noop : _b,\n      _c = _a.optionRenderer,\n      optionRenderer = _c === void 0 ? defaultOptionRenderer : _c,\n      children = _a.children,\n      _d = _a.placement,\n      placement = _d === void 0 ? 'right-bottom' : _d,\n      _onKeyDown = _a.onKeyDown,\n      onFocus = _a.onFocus,\n      onBlur = _a.onBlur,\n      onMouseDown = _a.onMouseDown,\n      onMouseEnter = _a.onMouseEnter,\n      onMouseLeave = _a.onMouseLeave,\n      size = _a.size,\n      _e = _a.variant,\n      variant = _e === void 0 ? 'secondary' : _e,\n      props = __rest(_a, [\"disabled\", \"icon\", \"label\", \"loading\", \"options\", \"onClick\", \"optionRenderer\", \"children\", \"placement\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"onMouseDown\", \"onMouseEnter\", \"onMouseLeave\", \"size\", \"variant\"]);\n\n  var innerRef = React.useRef(null);\n  var container = ref || innerRef;\n  var overlayRef = React.useRef(null);\n  var targetRef = React.useRef(null);\n  var flyoutOptions = React.useMemo(function () {\n    return transformOption(_options, rootId);\n  }, [_options]);\n\n  var _f = useDropdownFlyout({\n    flyoutOptions: flyoutOptions,\n    onClick: _onClick,\n    onKeyDown: _onKeyDown\n  }),\n      options = _f.options,\n      collapse = _f.collapse,\n      expand = _f.expand,\n      closeDropdown = _f.closeDropdown,\n      openDropdown = _f.openDropdown,\n      isOpen = _f.isOpen,\n      onClick = _f.onClick,\n      onKeyDown = _f.onKeyDown,\n      setMouseOver = _f.setMouseOver,\n      setFocused = _f.setFocused,\n      isExpanded = _f.isExpanded,\n      isHighlighted = _f.isHighlighted;\n\n  useClickOutside({\n    onClickOutside: closeDropdown,\n    refs: [container]\n  });\n  var element = typeof children === 'function' ? children({\n    isOpen: isOpen\n  }) : children;\n  var trigger = React.isValidElement(element) ? element : React.createElement(DefaultButton, {\n    children: label,\n    disabled: disabled,\n    loading: loading,\n    icon: icon,\n    size: size,\n    variant: variant\n  });\n  return React.createElement(\"div\", __assign({}, props, {\n    ref: container,\n    onKeyDown: onKeyDown,\n    onMouseEnter: function (e) {\n      setMouseOver(true);\n      onMouseEnter === null || onMouseEnter === void 0 ? void 0 : onMouseEnter(e);\n    },\n    onMouseLeave: function (e) {\n      setMouseOver(false);\n      onMouseLeave === null || onMouseLeave === void 0 ? void 0 : onMouseLeave(e);\n    },\n    onFocus: function (e) {\n      setFocused(true);\n      onFocus === null || onFocus === void 0 ? void 0 : onFocus(e);\n    },\n    onMouseDown: function (e) {\n      var _a, _b; // Discard firing of blur event\n      // when click was inside the dropdown\n\n\n      if (e.target instanceof Node && ((_a = container.current) === null || _a === void 0 ? void 0 : _a.contains(e.target))) {\n        e.preventDefault();\n        (_b = targetRef.current) === null || _b === void 0 ? void 0 : _b.focus();\n      }\n\n      onMouseDown === null || onMouseDown === void 0 ? void 0 : onMouseDown(e);\n    },\n    onBlur: function (e) {\n      setFocused(false);\n      closeDropdown();\n      onBlur === null || onBlur === void 0 ? void 0 : onBlur(e);\n    }\n  }), React.createElement(Trigger, __assign({}, {\n    isEnabled: isOpen,\n    enable: openDropdown,\n    disable: closeDropdown,\n    trigger: ['click'],\n    triggerRef: targetRef\n  }), React.cloneElement(trigger, __assign(__assign({}, trigger.props), {\n    tabIndex: 0\n  }))), React.createElement(DropdownFlyoutContext.Provider, {\n    value: {\n      expand: expand,\n      collapse: collapse,\n      onClick: onClick,\n      isExpanded: isExpanded,\n      isHighlighted: isHighlighted,\n      optionRenderer: optionRenderer\n    }\n  }, isOpen && React.createElement(FlyoutList, {\n    options: options,\n    targetRef: targetRef,\n    overlayRef: overlayRef,\n    placement: placement,\n    container: container.current || undefined,\n    padding: 4\n  })));\n});\nexport default DropdownFlyout;","map":{"version":3,"sources":["../../../../src/components/DropdownFlyout/DropdownFlyout.tsx"],"names":[],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { EllipsisVertical } from '@procore/core-icons/dist';\nimport React from 'react';\nimport { useClickOutside } from '../../effects/ClickOutside';\nimport { Trigger } from '../../state/Trigger';\nimport { Card } from '../Card';\nimport { DropdownButton } from '../Dropdown';\nimport { Overlay } from '../Overlay';\nimport { StyledDropdownFlyout, StyledDropdownFlyoutItem, } from './DropdownFlyout.styles';\nimport { rootId, } from './DropdownFlyout.types';\nimport { defaultOptionRenderer, noop, useDropdownFlyout, transformOption, DropdownFlyoutContext, useDropdownFlyoutContext, } from './DropdownFlyout.helpers';\nexport var FlyoutCaption = React.forwardRef(function FlyoutCaption(_a, ref) {\n    var option = _a.option, highlighted = _a.highlighted, optionRenderer = _a.optionRenderer, props = __rest(_a, [\"option\", \"highlighted\", \"optionRenderer\"]);\n    return (React.createElement(StyledDropdownFlyoutItem, __assign({}, props, { ref: ref, \"data-highlighted\": highlighted }), optionRenderer(option)));\n});\nFlyoutCaption.displayName = 'FlyoutCaption';\nexport function FlyoutItem(_a) {\n    var option = _a.option, container = _a.container, placement = _a.placement;\n    var captionRef = React.useRef(null);\n    var overlayRef = React.useRef(null);\n    var _b = useDropdownFlyoutContext(), isHighlighted = _b.isHighlighted, isExpanded = _b.isExpanded, _onClick = _b.onClick, expand = _b.expand, collapse = _b.collapse, optionRenderer = _b.optionRenderer;\n    var onMouseEnter = React.useCallback(function () { return expand(option); }, [option, expand]);\n    var onMouseLeave = React.useCallback(function (e) {\n        var _a;\n        if (e.relatedTarget instanceof Node &&\n            !((_a = overlayRef.current) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n            collapse(option);\n        }\n    }, [collapse, option]);\n    var onClick = React.useCallback(function () { return _onClick(option); }, [_onClick, option]);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(FlyoutCaption, { ref: captionRef, option: option.origin, onClick: onClick, optionRenderer: optionRenderer, highlighted: isHighlighted(option), onMouseEnter: onMouseEnter, onMouseLeave: onMouseLeave }),\n        Array.isArray(option.children) && isExpanded(option) ? (React.createElement(FlyoutList, { options: option.children, overlayRef: overlayRef, targetRef: captionRef, container: container, placement: placement })) : null));\n}\nexport function FlyoutList(_a) {\n    var options = _a.options, targetRef = _a.targetRef, ref = _a.overlayRef, container = _a.container, placement = _a.placement, props = __rest(_a, [\"options\", \"targetRef\", \"overlayRef\", \"container\", \"placement\"]);\n    var overlayRef = React.useRef(null);\n    return (React.createElement(Overlay, __assign({}, __assign({ ref: ref, overlayRef: overlayRef, targetRef: targetRef, placement: placement, container: container, padding: 0 }, props)),\n        React.createElement(Card, { shadowStrength: 2 },\n            React.createElement(StyledDropdownFlyout, null, options.map(function (option) { return (React.createElement(FlyoutItem, { key: option.id, option: option, container: container, placement: placement })); })))));\n}\nvar DefaultButton = React.forwardRef(function DefaultButton(_a, ref) {\n    var children = _a.children, icon = _a.icon, props = __rest(_a, [\"children\", \"icon\"]);\n    return (React.createElement(DropdownButton, __assign({}, props, { icon: props.loading ? undefined : !icon && !children ? (React.createElement(EllipsisVertical, null)) : (icon), arrow: !children ? false : true, ref: ref }), children));\n});\nexport var DropdownFlyout = React.forwardRef(function DropdownFlyout(_a, ref) {\n    var disabled = _a.disabled, icon = _a.icon, label = _a.label, loading = _a.loading, _options = _a.options, _b = _a.onClick, _onClick = _b === void 0 ? noop : _b, _c = _a.optionRenderer, optionRenderer = _c === void 0 ? defaultOptionRenderer : _c, children = _a.children, _d = _a.placement, placement = _d === void 0 ? 'right-bottom' : _d, _onKeyDown = _a.onKeyDown, onFocus = _a.onFocus, onBlur = _a.onBlur, onMouseDown = _a.onMouseDown, onMouseEnter = _a.onMouseEnter, onMouseLeave = _a.onMouseLeave, size = _a.size, _e = _a.variant, variant = _e === void 0 ? 'secondary' : _e, props = __rest(_a, [\"disabled\", \"icon\", \"label\", \"loading\", \"options\", \"onClick\", \"optionRenderer\", \"children\", \"placement\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"onMouseDown\", \"onMouseEnter\", \"onMouseLeave\", \"size\", \"variant\"]);\n    var innerRef = React.useRef(null);\n    var container = ref || innerRef;\n    var overlayRef = React.useRef(null);\n    var targetRef = React.useRef(null);\n    var flyoutOptions = React.useMemo(function () { return transformOption(_options, rootId); }, [_options]);\n    var _f = useDropdownFlyout({\n        flyoutOptions: flyoutOptions,\n        onClick: _onClick,\n        onKeyDown: _onKeyDown,\n    }), options = _f.options, collapse = _f.collapse, expand = _f.expand, closeDropdown = _f.closeDropdown, openDropdown = _f.openDropdown, isOpen = _f.isOpen, onClick = _f.onClick, onKeyDown = _f.onKeyDown, setMouseOver = _f.setMouseOver, setFocused = _f.setFocused, isExpanded = _f.isExpanded, isHighlighted = _f.isHighlighted;\n    useClickOutside({\n        onClickOutside: closeDropdown,\n        refs: [container],\n    });\n    var element = typeof children === 'function' ? children({ isOpen: isOpen }) : children;\n    var trigger = React.isValidElement(element) ? (element) : (React.createElement(DefaultButton, { children: label, disabled: disabled, loading: loading, icon: icon, size: size, variant: variant }));\n    return (React.createElement(\"div\", __assign({}, props, { ref: container, onKeyDown: onKeyDown, onMouseEnter: function (e) {\n            setMouseOver(true);\n            onMouseEnter === null || onMouseEnter === void 0 ? void 0 : onMouseEnter(e);\n        }, onMouseLeave: function (e) {\n            setMouseOver(false);\n            onMouseLeave === null || onMouseLeave === void 0 ? void 0 : onMouseLeave(e);\n        }, onFocus: function (e) {\n            setFocused(true);\n            onFocus === null || onFocus === void 0 ? void 0 : onFocus(e);\n        }, onMouseDown: function (e) {\n            var _a, _b;\n            // Discard firing of blur event\n            // when click was inside the dropdown\n            if (e.target instanceof Node && ((_a = container.current) === null || _a === void 0 ? void 0 : _a.contains(e.target))) {\n                e.preventDefault();\n                (_b = targetRef.current) === null || _b === void 0 ? void 0 : _b.focus();\n            }\n            onMouseDown === null || onMouseDown === void 0 ? void 0 : onMouseDown(e);\n        }, onBlur: function (e) {\n            setFocused(false);\n            closeDropdown();\n            onBlur === null || onBlur === void 0 ? void 0 : onBlur(e);\n        } }),\n        React.createElement(Trigger, __assign({}, {\n            isEnabled: isOpen,\n            enable: openDropdown,\n            disable: closeDropdown,\n            trigger: ['click'],\n            triggerRef: targetRef,\n        }), React.cloneElement(trigger, __assign(__assign({}, trigger.props), { tabIndex: 0 }))),\n        React.createElement(DropdownFlyoutContext.Provider, { value: {\n                expand: expand,\n                collapse: collapse,\n                onClick: onClick,\n                isExpanded: isExpanded,\n                isHighlighted: isHighlighted,\n                optionRenderer: optionRenderer,\n            } }, isOpen && (React.createElement(FlyoutList, { options: options, targetRef: targetRef, overlayRef: overlayRef, placement: placement, container: container.current || undefined, padding: 4 })))));\n});\nexport default DropdownFlyout;\n"]},"metadata":{},"sourceType":"module"}