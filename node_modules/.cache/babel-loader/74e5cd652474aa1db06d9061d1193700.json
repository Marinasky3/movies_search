{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport React from 'react';\nimport { ulid } from 'ulid';\nimport { rootId } from './DropdownFlyout.types';\nimport { StyledDropdownFlyoutExpandIcon, StyledDropdownFlyoutLabel } from './DropdownFlyout.styles';\nexport function noop() {}\nexport function returnFalse() {\n  return false;\n}\n\nfunction getFirst(arr) {\n  return arr[0];\n}\n\nfunction isRootOption(optionId) {\n  return optionId === rootId;\n}\n\nexport function hasChildren(option) {\n  return Array.isArray(option.children);\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'highlight':\n      return __assign(__assign({}, state), {\n        highlighted: action.option\n      });\n\n    case 'expand':\n      return __assign(__assign({}, state), {\n        highlighted: action.option,\n        expanded: __spreadArray(__spreadArray([], collectParentIds(state.options, action.option.id), true), [action.option.id], false)\n      });\n\n    case 'collapse':\n      return __assign(__assign({}, state), {\n        highlighted: action.option,\n        expanded: collectParentIds(state.options, action.option.id)\n      });\n\n    case 'close':\n      return __assign(__assign({}, state), {\n        expanded: [],\n        highlighted: getFirst(state.options),\n        isOpen: false\n      });\n\n    case 'open':\n      return __assign(__assign({}, state), {\n        isOpen: true\n      });\n\n    case 'setMouseOver':\n      return __assign(__assign({}, state), {\n        isMouseOver: action.isMouseOver\n      });\n\n    case 'setFocused':\n      return __assign(__assign({}, state), {\n        isFocused: action.isFocused\n      });\n\n    default:\n      return state;\n  }\n}\n\nfunction findById(options, optionId, initialValue) {\n  if (initialValue === void 0) {\n    initialValue = getFirst(options);\n  }\n\n  return options.reduce(function (result, current) {\n    if (current.id === optionId) {\n      return current;\n    }\n\n    if (current.children) {\n      return findById(current.children, optionId, result);\n    }\n\n    return result;\n  }, initialValue);\n}\n\nexport function transformOption(options, parentId) {\n  return options.reduce(function (acc, option) {\n    var id = ulid();\n\n    var updatedOption = __assign({\n      id: id,\n      parentId: parentId,\n      origin: option\n    }, Array.isArray(option.children) && {\n      children: transformOption(option.children, id)\n    });\n\n    return __spreadArray(__spreadArray([], acc, true), [updatedOption], false);\n  }, []);\n}\n\nfunction collectParentIds(options, optionId) {\n  var option = findById(options, optionId);\n\n  if (!isRootOption(option.parentId)) {\n    return __spreadArray(__spreadArray([], collectParentIds(options, option.parentId), true), [option.parentId], false);\n  }\n\n  return [option.parentId];\n}\n\nexport function useDropdownFlyout(_a) {\n  var flyoutOptions = _a.flyoutOptions,\n      _b = _a.onClick,\n      _onClick = _b === void 0 ? noop : _b,\n      _onKeyDown = _a.onKeyDown;\n\n  var _c = React.useReducer(reducer, {\n    options: flyoutOptions,\n    expanded: [],\n    highlighted: getFirst(flyoutOptions),\n    isMouseOver: false,\n    isFocused: false,\n    isOpen: false\n  }),\n      _d = _c[0],\n      options = _d.options,\n      expanded = _d.expanded,\n      highlighted = _d.highlighted,\n      isOpen = _d.isOpen,\n      isMouseOver = _d.isMouseOver,\n      isFocused = _d.isFocused,\n      dispatch = _c[1];\n\n  var setMouseOver = React.useCallback(function (isMouseOver) {\n    return dispatch({\n      type: 'setMouseOver',\n      isMouseOver: isMouseOver\n    });\n  }, []);\n  var setFocused = React.useCallback(function (isFocused) {\n    return dispatch({\n      type: 'setFocused',\n      isFocused: isFocused\n    });\n  }, []);\n\n  var isExpanded = function (option) {\n    return expanded.includes(option.id);\n  };\n\n  var isHighlighted = function (option) {\n    var parentIds = collectParentIds(options, highlighted.id);\n    var isCorrectId = option.id === highlighted.id || parentIds.some(function (id) {\n      return id === option.id;\n    });\n    return (isMouseOver || isFocused) && isCorrectId;\n  };\n\n  var findOptionById = React.useCallback(function (id) {\n    return findById(options, id);\n  }, [options]);\n  var expand = React.useCallback(function (option) {\n    return dispatch({\n      type: 'expand',\n      option: option\n    });\n  }, []);\n  var collapse = React.useCallback(function (option) {\n    return dispatch({\n      type: 'collapse',\n      option: option\n    });\n  }, []);\n  var highlight = React.useCallback(function (option) {\n    return dispatch({\n      type: 'highlight',\n      option: option\n    });\n  }, []);\n  var traversingHighlight = React.useCallback(function (item) {\n    var tier = isRootOption(highlighted.parentId) ? options : findOptionById(highlighted.parentId).children || [];\n    var optionIndex = tier.findIndex(function (item) {\n      return item.id === highlighted.id;\n    });\n\n    switch (item) {\n      case 'next':\n        var nextIndex = optionIndex + 1 >= tier.length ? 0 : optionIndex + 1;\n        highlight(tier[nextIndex]);\n        break;\n\n      case 'prev':\n        var prevIndex = optionIndex - 1 < 0 ? tier.length - 1 : optionIndex - 1;\n        highlight(tier[prevIndex]);\n        break;\n\n      case 'children':\n        if (Array.isArray(highlighted.children)) {\n          expand(highlighted);\n          highlight(getFirst(highlighted.children));\n        }\n\n        break;\n\n      case 'parent':\n        if (!isRootOption(highlighted.parentId)) {\n          var parentOption = findOptionById(highlighted.parentId);\n          collapse(parentOption);\n        }\n\n        break;\n\n      default:\n        return;\n    }\n  }, [options, findOptionById, collapse, highlighted, expand, highlight]);\n  var closeDropdown = React.useCallback(function () {\n    dispatch({\n      type: 'close'\n    });\n  }, []);\n  var openDropdown = React.useCallback(function () {\n    dispatch({\n      type: 'open'\n    });\n  }, []);\n  var onClick = React.useCallback(function (option) {\n    if (!hasChildren(option.origin)) {\n      _onClick(option.origin);\n\n      closeDropdown();\n    }\n  }, [_onClick, closeDropdown]);\n  var onKeyDown = React.useCallback(function (e) {\n    var key = e.key;\n\n    switch (key) {\n      case 'Enter':\n        e.preventDefault();\n\n        if (!isOpen && isFocused) {\n          openDropdown();\n        } else {\n          if (hasChildren(highlighted.origin)) {\n            traversingHighlight('children');\n          } else {\n            onClick(highlighted);\n          }\n        }\n\n        break;\n\n      case 'Escape':\n      case 'Esc':\n        e.preventDefault();\n\n        if (isRootOption(highlighted.parentId)) {\n          closeDropdown();\n        } else {\n          traversingHighlight('parent');\n        }\n\n        break;\n\n      case 'ArrowDown':\n      case 'Down':\n        e.preventDefault();\n        traversingHighlight('next');\n        break;\n\n      case 'ArrowUp':\n      case 'Up':\n        e.preventDefault();\n        traversingHighlight('prev');\n        break;\n    }\n\n    _onKeyDown === null || _onKeyDown === void 0 ? void 0 : _onKeyDown(e);\n  }, [closeDropdown, openDropdown, traversingHighlight, highlighted, isOpen, isFocused, onClick, _onKeyDown]);\n  return {\n    isFocused: isFocused,\n    isMouseOver: isMouseOver,\n    isOpen: isOpen,\n    options: options,\n    expanded: expanded,\n    highlighted: highlighted,\n    expand: expand,\n    collapse: collapse,\n    isHighlighted: isHighlighted,\n    isExpanded: isExpanded,\n    closeDropdown: closeDropdown,\n    openDropdown: openDropdown,\n    onKeyDown: onKeyDown,\n    onClick: onClick,\n    setMouseOver: setMouseOver,\n    setFocused: setFocused\n  };\n}\nexport function defaultOptionRenderer(option) {\n  return React.createElement(React.Fragment, null, React.createElement(StyledDropdownFlyoutLabel, null, option.label), hasChildren(option) && React.createElement(StyledDropdownFlyoutExpandIcon, {\n    \"data-qa\": \"core-dropdown-flyout-option-expand-icon\"\n  }));\n}\nexport var DropdownFlyoutContext = React.createContext({\n  onClick: noop,\n  expand: noop,\n  collapse: noop,\n  optionRenderer: defaultOptionRenderer,\n  isExpanded: returnFalse,\n  isHighlighted: returnFalse\n});\nexport var useDropdownFlyoutContext = function () {\n  return React.useContext(DropdownFlyoutContext);\n};","map":{"version":3,"sources":["../../../../src/components/DropdownFlyout/DropdownFlyout.helpers.tsx"],"names":[],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport React from 'react';\nimport { ulid } from 'ulid';\nimport { rootId, } from './DropdownFlyout.types';\nimport { StyledDropdownFlyoutExpandIcon, StyledDropdownFlyoutLabel, } from './DropdownFlyout.styles';\nexport function noop() { }\nexport function returnFalse() {\n    return false;\n}\nfunction getFirst(arr) {\n    return arr[0];\n}\nfunction isRootOption(optionId) {\n    return optionId === rootId;\n}\nexport function hasChildren(option) {\n    return Array.isArray(option.children);\n}\nfunction reducer(state, action) {\n    switch (action.type) {\n        case 'highlight':\n            return __assign(__assign({}, state), { highlighted: action.option });\n        case 'expand':\n            return __assign(__assign({}, state), { highlighted: action.option, expanded: __spreadArray(__spreadArray([], collectParentIds(state.options, action.option.id), true), [\n                    action.option.id,\n                ], false) });\n        case 'collapse':\n            return __assign(__assign({}, state), { highlighted: action.option, expanded: collectParentIds(state.options, action.option.id) });\n        case 'close':\n            return __assign(__assign({}, state), { expanded: [], highlighted: getFirst(state.options), isOpen: false });\n        case 'open':\n            return __assign(__assign({}, state), { isOpen: true });\n        case 'setMouseOver':\n            return __assign(__assign({}, state), { isMouseOver: action.isMouseOver });\n        case 'setFocused':\n            return __assign(__assign({}, state), { isFocused: action.isFocused });\n        default:\n            return state;\n    }\n}\nfunction findById(options, optionId, initialValue) {\n    if (initialValue === void 0) { initialValue = getFirst(options); }\n    return options.reduce(function (result, current) {\n        if (current.id === optionId) {\n            return current;\n        }\n        if (current.children) {\n            return findById(current.children, optionId, result);\n        }\n        return result;\n    }, initialValue);\n}\nexport function transformOption(options, parentId) {\n    return options.reduce(function (acc, option) {\n        var id = ulid();\n        var updatedOption = __assign({ id: id, parentId: parentId, origin: option }, (Array.isArray(option.children) && {\n            children: transformOption(option.children, id),\n        }));\n        return __spreadArray(__spreadArray([], acc, true), [updatedOption], false);\n    }, []);\n}\nfunction collectParentIds(options, optionId) {\n    var option = findById(options, optionId);\n    if (!isRootOption(option.parentId)) {\n        return __spreadArray(__spreadArray([], collectParentIds(options, option.parentId), true), [option.parentId], false);\n    }\n    return [option.parentId];\n}\nexport function useDropdownFlyout(_a) {\n    var flyoutOptions = _a.flyoutOptions, _b = _a.onClick, _onClick = _b === void 0 ? noop : _b, _onKeyDown = _a.onKeyDown;\n    var _c = React.useReducer(reducer, {\n        options: flyoutOptions,\n        expanded: [],\n        highlighted: getFirst(flyoutOptions),\n        isMouseOver: false,\n        isFocused: false,\n        isOpen: false,\n    }), _d = _c[0], options = _d.options, expanded = _d.expanded, highlighted = _d.highlighted, isOpen = _d.isOpen, isMouseOver = _d.isMouseOver, isFocused = _d.isFocused, dispatch = _c[1];\n    var setMouseOver = React.useCallback(function (isMouseOver) { return dispatch({ type: 'setMouseOver', isMouseOver: isMouseOver }); }, []);\n    var setFocused = React.useCallback(function (isFocused) { return dispatch({ type: 'setFocused', isFocused: isFocused }); }, []);\n    var isExpanded = function (option) { return expanded.includes(option.id); };\n    var isHighlighted = function (option) {\n        var parentIds = collectParentIds(options, highlighted.id);\n        var isCorrectId = option.id === highlighted.id || parentIds.some(function (id) { return id === option.id; });\n        return (isMouseOver || isFocused) && isCorrectId;\n    };\n    var findOptionById = React.useCallback(function (id) { return findById(options, id); }, [options]);\n    var expand = React.useCallback(function (option) {\n        return dispatch({\n            type: 'expand',\n            option: option,\n        });\n    }, []);\n    var collapse = React.useCallback(function (option) {\n        return dispatch({\n            type: 'collapse',\n            option: option,\n        });\n    }, []);\n    var highlight = React.useCallback(function (option) {\n        return dispatch({\n            type: 'highlight',\n            option: option,\n        });\n    }, []);\n    var traversingHighlight = React.useCallback(function (item) {\n        var tier = isRootOption(highlighted.parentId)\n            ? options\n            : findOptionById(highlighted.parentId).children || [];\n        var optionIndex = tier.findIndex(function (item) { return item.id === highlighted.id; });\n        switch (item) {\n            case 'next':\n                var nextIndex = optionIndex + 1 >= tier.length ? 0 : optionIndex + 1;\n                highlight(tier[nextIndex]);\n                break;\n            case 'prev':\n                var prevIndex = optionIndex - 1 < 0 ? tier.length - 1 : optionIndex - 1;\n                highlight(tier[prevIndex]);\n                break;\n            case 'children':\n                if (Array.isArray(highlighted.children)) {\n                    expand(highlighted);\n                    highlight(getFirst(highlighted.children));\n                }\n                break;\n            case 'parent':\n                if (!isRootOption(highlighted.parentId)) {\n                    var parentOption = findOptionById(highlighted.parentId);\n                    collapse(parentOption);\n                }\n                break;\n            default:\n                return;\n        }\n    }, [options, findOptionById, collapse, highlighted, expand, highlight]);\n    var closeDropdown = React.useCallback(function () {\n        dispatch({ type: 'close' });\n    }, []);\n    var openDropdown = React.useCallback(function () {\n        dispatch({ type: 'open' });\n    }, []);\n    var onClick = React.useCallback(function (option) {\n        if (!hasChildren(option.origin)) {\n            _onClick(option.origin);\n            closeDropdown();\n        }\n    }, [_onClick, closeDropdown]);\n    var onKeyDown = React.useCallback(function (e) {\n        var key = e.key;\n        switch (key) {\n            case 'Enter':\n                e.preventDefault();\n                if (!isOpen && isFocused) {\n                    openDropdown();\n                }\n                else {\n                    if (hasChildren(highlighted.origin)) {\n                        traversingHighlight('children');\n                    }\n                    else {\n                        onClick(highlighted);\n                    }\n                }\n                break;\n            case 'Escape':\n            case 'Esc':\n                e.preventDefault();\n                if (isRootOption(highlighted.parentId)) {\n                    closeDropdown();\n                }\n                else {\n                    traversingHighlight('parent');\n                }\n                break;\n            case 'ArrowDown':\n            case 'Down':\n                e.preventDefault();\n                traversingHighlight('next');\n                break;\n            case 'ArrowUp':\n            case 'Up':\n                e.preventDefault();\n                traversingHighlight('prev');\n                break;\n        }\n        _onKeyDown === null || _onKeyDown === void 0 ? void 0 : _onKeyDown(e);\n    }, [\n        closeDropdown,\n        openDropdown,\n        traversingHighlight,\n        highlighted,\n        isOpen,\n        isFocused,\n        onClick,\n        _onKeyDown,\n    ]);\n    return {\n        isFocused: isFocused,\n        isMouseOver: isMouseOver,\n        isOpen: isOpen,\n        options: options,\n        expanded: expanded,\n        highlighted: highlighted,\n        expand: expand,\n        collapse: collapse,\n        isHighlighted: isHighlighted,\n        isExpanded: isExpanded,\n        closeDropdown: closeDropdown,\n        openDropdown: openDropdown,\n        onKeyDown: onKeyDown,\n        onClick: onClick,\n        setMouseOver: setMouseOver,\n        setFocused: setFocused,\n    };\n}\nexport function defaultOptionRenderer(option) {\n    return (React.createElement(React.Fragment, null,\n        React.createElement(StyledDropdownFlyoutLabel, null, option.label),\n        hasChildren(option) && (React.createElement(StyledDropdownFlyoutExpandIcon, { \"data-qa\": \"core-dropdown-flyout-option-expand-icon\" }))));\n}\nexport var DropdownFlyoutContext = React.createContext({\n    onClick: noop,\n    expand: noop,\n    collapse: noop,\n    optionRenderer: defaultOptionRenderer,\n    isExpanded: returnFalse,\n    isHighlighted: returnFalse,\n});\nexport var useDropdownFlyoutContext = function () {\n    return React.useContext(DropdownFlyoutContext);\n};\n"]},"metadata":{},"sourceType":"module"}