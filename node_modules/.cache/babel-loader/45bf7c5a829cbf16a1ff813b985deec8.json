{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport React from 'react';\nimport { useLayoutEventListener } from '../effects/EventListener';\nimport { getBoundingRect } from '../utils/dom';\nimport { getAnchorPosition } from '../utils/getAnchorPosition';\nexport var initAnchor = {\n  left: 0,\n  minWidth: 0,\n  placement: 'bottom-left',\n  top: 0\n};\n/* HOOK */\n\nexport function useAnchor(_a) {\n  var _b = _a.canFlip,\n      canFlip = _b === void 0 ? true : _b,\n      _c = _a.dependencies,\n      dependencies = _c === void 0 ? [] : _c,\n      _d = _a.onLayout,\n      onLayout = _d === void 0 ? function () {} : _d,\n      _e = _a.padding,\n      padding = _e === void 0 ? 0 : _e,\n      _f = _a.placement,\n      placement = _f === void 0 ? 'bottom-left' : _f,\n      overlayRef = _a.overlayRef,\n      targetRef = _a.targetRef,\n      _g = _a.shrinkOverlay,\n      shrinkOverlay = _g === void 0 ? false : _g;\n\n  var _h = React.useState(__assign(__assign({}, initAnchor), {\n    placement: placement\n  })),\n      anchor = _h[0],\n      setAnchor = _h[1];\n\n  var viewChangeHandler = function () {\n    if (overlayRef.current && targetRef.current) {\n      var target = getBoundingRect(targetRef.current);\n\n      if (!shrinkOverlay) {\n        // we should set minWidth before calculation\n        overlayRef.current.style.minWidth = \"\".concat(target.width, \"px\");\n      }\n\n      var newAnchor = getAnchorPosition(placement, padding, undefined, target, getBoundingRect(overlayRef.current), canFlip);\n\n      if (newAnchor.placement !== anchor.placement) {\n        setAnchor(newAnchor);\n      }\n\n      onLayout(newAnchor);\n    }\n  };\n\n  useLayoutEventListener({\n    event: 'scroll',\n    handler: viewChangeHandler,\n    options: {\n      capture: true\n    }\n  });\n  useLayoutEventListener({\n    event: 'resize',\n    handler: viewChangeHandler\n  });\n  useLayoutEventListener({\n    event: 'load',\n    handler: viewChangeHandler\n  });\n  React.useLayoutEffect(function () {\n    viewChangeHandler();\n  }, __spreadArray([overlayRef], dependencies, true));\n  return anchor;\n}\n/* DECORATOR */\n\nexport function withAnchor(config) {\n  return function (Component) {\n    return function WithAnchor(props) {\n      return React.createElement(Component, __assign({}, props, {\n        anchor: useAnchor(config)\n      }));\n    };\n  };\n}\n/* RENDER PROP */\n\nexport function Anchor(_a) {\n  var children = _a.children,\n      overlayRef = _a.overlayRef,\n      targetRef = _a.targetRef,\n      props = __rest(_a, [\"children\", \"overlayRef\", \"targetRef\"]);\n\n  var anchor = useAnchor(__assign(__assign({}, props), {\n    overlayRef: overlayRef,\n    targetRef: targetRef\n  }));\n  var content = typeof children === 'function' ? children(anchor) : children;\n  return content && React.cloneElement(content, __assign(__assign({}, content.props), {\n    placement: anchor.placement,\n    ref: overlayRef\n  }));\n}\n/* CONTEXT */\n\nexport var AnchorContext = React.createContext(initAnchor);\nexport function AnchorProvider(_a) {\n  var children = _a.children,\n      props = __rest(_a, [\"children\"]);\n\n  return React.createElement(AnchorContext.Provider, {\n    value: useAnchor(props)\n  }, children);\n}\nexport function useAnchorContext() {\n  return React.useContext(AnchorContext);\n}\nexport var consumeAnchor = useAnchorContext;","map":{"version":3,"sources":["../../../src/state/Anchor.tsx"],"names":[],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport React from 'react';\nimport { useLayoutEventListener } from '../effects/EventListener';\nimport { getBoundingRect } from '../utils/dom';\nimport { getAnchorPosition } from '../utils/getAnchorPosition';\nexport var initAnchor = {\n    left: 0,\n    minWidth: 0,\n    placement: 'bottom-left',\n    top: 0,\n};\n/* HOOK */\nexport function useAnchor(_a) {\n    var _b = _a.canFlip, canFlip = _b === void 0 ? true : _b, _c = _a.dependencies, dependencies = _c === void 0 ? [] : _c, _d = _a.onLayout, onLayout = _d === void 0 ? function () { } : _d, _e = _a.padding, padding = _e === void 0 ? 0 : _e, _f = _a.placement, placement = _f === void 0 ? 'bottom-left' : _f, overlayRef = _a.overlayRef, targetRef = _a.targetRef, _g = _a.shrinkOverlay, shrinkOverlay = _g === void 0 ? false : _g;\n    var _h = React.useState(__assign(__assign({}, initAnchor), { placement: placement })), anchor = _h[0], setAnchor = _h[1];\n    var viewChangeHandler = function () {\n        if (overlayRef.current && targetRef.current) {\n            var target = getBoundingRect(targetRef.current);\n            if (!shrinkOverlay) {\n                // we should set minWidth before calculation\n                overlayRef.current.style.minWidth = \"\".concat(target.width, \"px\");\n            }\n            var newAnchor = getAnchorPosition(placement, padding, undefined, target, getBoundingRect(overlayRef.current), canFlip);\n            if (newAnchor.placement !== anchor.placement) {\n                setAnchor(newAnchor);\n            }\n            onLayout(newAnchor);\n        }\n    };\n    useLayoutEventListener({\n        event: 'scroll',\n        handler: viewChangeHandler,\n        options: {\n            capture: true,\n        },\n    });\n    useLayoutEventListener({\n        event: 'resize',\n        handler: viewChangeHandler,\n    });\n    useLayoutEventListener({\n        event: 'load',\n        handler: viewChangeHandler,\n    });\n    React.useLayoutEffect(function () {\n        viewChangeHandler();\n    }, __spreadArray([overlayRef], dependencies, true));\n    return anchor;\n}\n/* DECORATOR */\nexport function withAnchor(config) {\n    return function (Component) {\n        return function WithAnchor(props) {\n            return React.createElement(Component, __assign({}, props, { anchor: useAnchor(config) }));\n        };\n    };\n}\n/* RENDER PROP */\nexport function Anchor(_a) {\n    var children = _a.children, overlayRef = _a.overlayRef, targetRef = _a.targetRef, props = __rest(_a, [\"children\", \"overlayRef\", \"targetRef\"]);\n    var anchor = useAnchor(__assign(__assign({}, props), { overlayRef: overlayRef, targetRef: targetRef }));\n    var content = typeof children === 'function'\n        ? children(anchor)\n        : children;\n    return (content &&\n        React.cloneElement(content, __assign(__assign({}, content.props), { placement: anchor.placement, ref: overlayRef })));\n}\n/* CONTEXT */\nexport var AnchorContext = React.createContext(initAnchor);\nexport function AnchorProvider(_a) {\n    var children = _a.children, props = __rest(_a, [\"children\"]);\n    return (React.createElement(AnchorContext.Provider, { value: useAnchor(props) }, children));\n}\nexport function useAnchorContext() {\n    return React.useContext(AnchorContext);\n}\nexport var consumeAnchor = useAnchorContext;\n"]},"metadata":{},"sourceType":"module"}