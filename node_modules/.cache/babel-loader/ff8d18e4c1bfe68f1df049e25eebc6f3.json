{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React from 'react';\nimport { addSubcomponents } from '../../utils/addSubcomponents';\nimport { NextGrid } from '../NextGrid';\nimport { StyledPageHeader, StyledBody, StyledAside, StyledPageMain, StyledPageContainer, StyledPageTitle, StyledPageTabs, StyledPageBanner, StyledPageBreadcrumbs, StyledAsidePanel, StyledFooter } from './PageLayout.styles';\nimport { mergeRefs } from '../../effects/mergeRefs';\nimport { pageLayoutRootDataAttr } from './PageLayout.constants';\nimport { useResize } from '../../effects/Resize';\nimport { useScroll } from '../../effects/Scroll';\nimport Flex from '../Flex';\nexport var PageContext = React.createContext({\n  bodyRef: React.createRef(),\n  footerRef: React.createRef(),\n  aside: {\n    open: function () {},\n    close: function () {},\n    isOpen: false\n  }\n});\n\nfunction getIsIntersectingVertically(upperEl, lowerEl) {\n  return upperEl.getBoundingClientRect().bottom > lowerEl.getBoundingClientRect().top;\n}\n\nfunction getIsIntersectingHorizontally(leftEl, rightEl) {\n  return leftEl.getBoundingClientRect().right > rightEl.getBoundingClientRect().left;\n}\n\nvar PageGrid = function (_a) {\n  var gutterX = _a.gutterX,\n      props = __rest(_a, [\"gutterX\"]);\n\n  return React.createElement(NextGrid, __assign({\n    gutterX: gutterX !== null && gutterX !== void 0 ? gutterX : 'lg'\n  }, props));\n};\n\nvar PageHeader = React.forwardRef(function PageHeader(_a, ref) {\n  var transparent = _a.transparent,\n      props = __rest(_a, [\"transparent\"]);\n\n  return React.createElement(StyledPageHeader, __assign({\n    \"$transparent\": transparent\n  }, props, {\n    ref: ref\n  }));\n});\nvar PageBody = React.forwardRef(function PageBody(props, ref) {\n  var bodyRef = React.useContext(PageContext).bodyRef;\n  return React.createElement(StyledBody, __assign({}, props, {\n    ref: mergeRefs(ref, bodyRef)\n  }));\n});\nvar PageFooter = React.forwardRef(function PageFooter(props, ref) {\n  var _a = React.useContext(PageContext),\n      bodyRef = _a.bodyRef,\n      footerRef = _a.footerRef,\n      aside = _a.aside;\n\n  var _b = React.useState(false),\n      isIntersecting = _b[0],\n      setIsIntersecting = _b[1];\n\n  function calculateIntersections() {\n    if (!footerRef.current || !bodyRef.current) {\n      return;\n    }\n\n    setIsIntersecting(getIsIntersectingVertically(bodyRef.current, footerRef.current));\n  }\n\n  React.useEffect(calculateIntersections, []);\n  useScroll({\n    onScroll: calculateIntersections\n  });\n  useResize({\n    onResize: calculateIntersections\n  });\n  return React.createElement(React.Fragment, null, React.createElement(StyledFooter, __assign({}, props, {\n    \"$isAsideOpen\": aside.isOpen,\n    \"$hasShadow\": isIntersecting,\n    ref: mergeRefs(ref, footerRef)\n  })));\n});\nvar PageAside = React.forwardRef(function PageAside(_a, ref) {\n  var children = _a.children,\n      controlledIsOpen = _a.open,\n      props = __rest(_a, [\"children\", \"open\"]);\n\n  var _b = React.useContext(PageContext).aside,\n      isOpen = _b.isOpen,\n      open = _b.open,\n      close = _b.close;\n  var footerRef = React.useContext(PageContext).footerRef;\n  var innerRef = React.useRef(null);\n  var upperRef = React.useRef(null);\n  var lowerRef = React.useRef(null);\n\n  var _c = React.useState(0),\n      topOffset = _c[0],\n      setTopOffset = _c[1];\n\n  var _d = React.useState(0),\n      bottomOffset = _d[0],\n      setBottomOffset = _d[1];\n\n  React.useEffect(function () {\n    if (controlledIsOpen) {\n      open();\n    } else {\n      close();\n    }\n  }, [controlledIsOpen]);\n\n  function calculateVerticalOffsets() {\n    var _a, _b;\n\n    if (!innerRef.current || !upperRef.current) {\n      return;\n    } // push from the global header\n\n\n    var upperRect = upperRef.current.getBoundingClientRect();\n    var viewportTopOffset = (_a = upperRect.y) !== null && _a !== void 0 ? _a : upperRect.top;\n    var upperTopOffset = Math.max(viewportTopOffset, 0);\n    setTopOffset(upperTopOffset);\n\n    if (!lowerRef.current) {\n      return;\n    } // push from the global footer\n\n\n    var lowerRect = lowerRef.current.getBoundingClientRect();\n    var lowerTopOffset = (_b = lowerRect.y) !== null && _b !== void 0 ? _b : lowerRect.top;\n    var viewportHeight = document.documentElement.clientHeight;\n    var globalFooterOffset = Math.max(viewportHeight - lowerTopOffset, 0);\n    setBottomOffset(globalFooterOffset);\n\n    if (!footerRef.current) {\n      return;\n    } // occasionally push from the sticky footer too, relevant on smaller screens\n\n\n    var isIntersectingWithFooter = getIsIntersectingHorizontally(footerRef.current, innerRef.current);\n\n    if (isIntersectingWithFooter) {\n      var footerHeight = footerRef.current.getBoundingClientRect().height;\n      setBottomOffset(globalFooterOffset + footerHeight);\n      return;\n    }\n  }\n\n  useScroll({\n    onScroll: calculateVerticalOffsets\n  });\n  useResize({\n    onResize: calculateVerticalOffsets\n  });\n  React.useEffect(function () {\n    if (isOpen) {\n      calculateVerticalOffsets();\n    }\n  }, [isOpen]);\n  return isOpen ? React.createElement(React.Fragment, null, React.createElement(Flex, {\n    alignSelf: \"flex-start\",\n    ref: upperRef\n  }), React.createElement(StyledAside, __assign({}, props, {\n    ref: mergeRefs(ref, innerRef, calculateVerticalOffsets)\n  }), React.createElement(StyledAsidePanel, {\n    \"$offsetTop\": topOffset,\n    \"$minusHeight\": topOffset + bottomOffset\n  }, children)), React.createElement(Flex, {\n    alignSelf: \"flex-end\",\n    ref: lowerRef\n  })) : null;\n});\nvar PageContainer = React.forwardRef(function PageContainer(props, ref) {\n  var _a = React.useState(true),\n      isAsideOpen = _a[0],\n      setIsAsideOpen = _a[1];\n\n  var openAside = function () {\n    return setIsAsideOpen(true);\n  };\n\n  var closeAside = function () {\n    return setIsAsideOpen(false);\n  };\n\n  var bodyRef = React.useRef(null);\n  var footerRef = React.useRef(null);\n  return React.createElement(PageContext.Provider, {\n    value: {\n      bodyRef: bodyRef,\n      footerRef: footerRef,\n      aside: {\n        open: openAside,\n        close: closeAside,\n        isOpen: isAsideOpen\n      }\n    }\n  }, React.createElement(StyledPageContainer, __assign({}, props, {\n    ref: ref\n  })));\n});\nvar PageMain = React.forwardRef(function PageMain(props, ref) {\n  var _a;\n\n  var attrs = (_a = {}, _a[pageLayoutRootDataAttr] = true, _a);\n  return React.createElement(PageGrid, null, React.createElement(StyledPageMain, __assign({}, props, attrs, {\n    ref: ref\n  })));\n});\nvar PageBreadcrumbs = React.forwardRef(function PageBreadcrumbs(props, ref) {\n  return React.createElement(StyledPageBreadcrumbs, __assign({\n    ref: ref\n  }, props));\n});\nvar PageBanner = React.forwardRef(function PageBanner(props, ref) {\n  return React.createElement(StyledPageBanner, __assign({\n    ref: ref\n  }, props));\n});\nvar PageTitle = React.forwardRef(function PageTitle(props, ref) {\n  return React.createElement(StyledPageTitle, __assign({\n    ref: ref\n  }, props));\n});\nvar PageTabs = React.forwardRef(function PageTabs(props, ref) {\n  return React.createElement(StyledPageTabs, __assign({\n    ref: ref\n  }, props));\n});\nPageGrid.displayName = 'Page.Grid';\nPageHeader.displayName = 'Page.Header';\nPageBanner.displayName = 'Page.Banner';\nPageBreadcrumbs.displayName = 'Page.Breadcrumbs';\nPageTitle.displayName = 'Page.Title';\nPageTabs.displayName = 'Page.Tabs';\nPageBody.displayName = 'Page.Body';\nPageFooter.displayName = 'Page.Footer';\nPageAside.displayName = 'Page.Aside';\nPageContainer.displayName = 'Page';\nPageMain.displayName = 'Page.Main';\nexport var Page = addSubcomponents({\n  Header: PageHeader,\n  Banner: PageBanner,\n  Breadcrumbs: PageBreadcrumbs,\n  Title: PageTitle,\n  Tabs: PageTabs,\n  Footer: PageFooter,\n  Body: PageBody,\n  Main: PageMain,\n  Aside: PageAside,\n  // Grid utilities\n  Grid: PageGrid,\n  Column: NextGrid.Col,\n  Row: NextGrid.Row\n}, PageContainer);","map":{"version":3,"sources":["../../../../src/layouts/PageLayout/PageLayout.tsx"],"names":[],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from 'react';\nimport { addSubcomponents } from '../../utils/addSubcomponents';\nimport { NextGrid } from '../NextGrid';\nimport { StyledPageHeader, StyledBody, StyledAside, StyledPageMain, StyledPageContainer, StyledPageTitle, StyledPageTabs, StyledPageBanner, StyledPageBreadcrumbs, StyledAsidePanel, StyledFooter, } from './PageLayout.styles';\nimport { mergeRefs } from '../../effects/mergeRefs';\nimport { pageLayoutRootDataAttr } from './PageLayout.constants';\nimport { useResize } from '../../effects/Resize';\nimport { useScroll } from '../../effects/Scroll';\nimport Flex from '../Flex';\nexport var PageContext = React.createContext({\n    bodyRef: React.createRef(),\n    footerRef: React.createRef(),\n    aside: {\n        open: function () { },\n        close: function () { },\n        isOpen: false,\n    },\n});\nfunction getIsIntersectingVertically(upperEl, lowerEl) {\n    return (upperEl.getBoundingClientRect().bottom > lowerEl.getBoundingClientRect().top);\n}\nfunction getIsIntersectingHorizontally(leftEl, rightEl) {\n    return (leftEl.getBoundingClientRect().right > rightEl.getBoundingClientRect().left);\n}\nvar PageGrid = function (_a) {\n    var gutterX = _a.gutterX, props = __rest(_a, [\"gutterX\"]);\n    return React.createElement(NextGrid, __assign({ gutterX: gutterX !== null && gutterX !== void 0 ? gutterX : 'lg' }, props));\n};\nvar PageHeader = React.forwardRef(function PageHeader(_a, ref) {\n    var transparent = _a.transparent, props = __rest(_a, [\"transparent\"]);\n    return React.createElement(StyledPageHeader, __assign({ \"$transparent\": transparent }, props, { ref: ref }));\n});\nvar PageBody = React.forwardRef(function PageBody(props, ref) {\n    var bodyRef = React.useContext(PageContext).bodyRef;\n    return React.createElement(StyledBody, __assign({}, props, { ref: mergeRefs(ref, bodyRef) }));\n});\nvar PageFooter = React.forwardRef(function PageFooter(props, ref) {\n    var _a = React.useContext(PageContext), bodyRef = _a.bodyRef, footerRef = _a.footerRef, aside = _a.aside;\n    var _b = React.useState(false), isIntersecting = _b[0], setIsIntersecting = _b[1];\n    function calculateIntersections() {\n        if (!footerRef.current || !bodyRef.current) {\n            return;\n        }\n        setIsIntersecting(getIsIntersectingVertically(bodyRef.current, footerRef.current));\n    }\n    React.useEffect(calculateIntersections, []);\n    useScroll({ onScroll: calculateIntersections });\n    useResize({ onResize: calculateIntersections });\n    return (React.createElement(React.Fragment, null,\n        React.createElement(StyledFooter, __assign({}, props, { \"$isAsideOpen\": aside.isOpen, \"$hasShadow\": isIntersecting, ref: mergeRefs(ref, footerRef) }))));\n});\nvar PageAside = React.forwardRef(function PageAside(_a, ref) {\n    var children = _a.children, controlledIsOpen = _a.open, props = __rest(_a, [\"children\", \"open\"]);\n    var _b = React.useContext(PageContext).aside, isOpen = _b.isOpen, open = _b.open, close = _b.close;\n    var footerRef = React.useContext(PageContext).footerRef;\n    var innerRef = React.useRef(null);\n    var upperRef = React.useRef(null);\n    var lowerRef = React.useRef(null);\n    var _c = React.useState(0), topOffset = _c[0], setTopOffset = _c[1];\n    var _d = React.useState(0), bottomOffset = _d[0], setBottomOffset = _d[1];\n    React.useEffect(function () {\n        if (controlledIsOpen) {\n            open();\n        }\n        else {\n            close();\n        }\n    }, [controlledIsOpen]);\n    function calculateVerticalOffsets() {\n        var _a, _b;\n        if (!innerRef.current || !upperRef.current) {\n            return;\n        }\n        // push from the global header\n        var upperRect = upperRef.current.getBoundingClientRect();\n        var viewportTopOffset = (_a = upperRect.y) !== null && _a !== void 0 ? _a : upperRect.top;\n        var upperTopOffset = Math.max(viewportTopOffset, 0);\n        setTopOffset(upperTopOffset);\n        if (!lowerRef.current) {\n            return;\n        }\n        // push from the global footer\n        var lowerRect = lowerRef.current.getBoundingClientRect();\n        var lowerTopOffset = (_b = lowerRect.y) !== null && _b !== void 0 ? _b : lowerRect.top;\n        var viewportHeight = document.documentElement.clientHeight;\n        var globalFooterOffset = Math.max(viewportHeight - lowerTopOffset, 0);\n        setBottomOffset(globalFooterOffset);\n        if (!footerRef.current) {\n            return;\n        }\n        // occasionally push from the sticky footer too, relevant on smaller screens\n        var isIntersectingWithFooter = getIsIntersectingHorizontally(footerRef.current, innerRef.current);\n        if (isIntersectingWithFooter) {\n            var footerHeight = footerRef.current.getBoundingClientRect().height;\n            setBottomOffset(globalFooterOffset + footerHeight);\n            return;\n        }\n    }\n    useScroll({ onScroll: calculateVerticalOffsets });\n    useResize({ onResize: calculateVerticalOffsets });\n    React.useEffect(function () {\n        if (isOpen) {\n            calculateVerticalOffsets();\n        }\n    }, [isOpen]);\n    return isOpen ? (React.createElement(React.Fragment, null,\n        React.createElement(Flex, { alignSelf: \"flex-start\", ref: upperRef }),\n        React.createElement(StyledAside, __assign({}, props, { ref: mergeRefs(ref, innerRef, calculateVerticalOffsets) }),\n            React.createElement(StyledAsidePanel, { \"$offsetTop\": topOffset, \"$minusHeight\": topOffset + bottomOffset }, children)),\n        React.createElement(Flex, { alignSelf: \"flex-end\", ref: lowerRef }))) : null;\n});\nvar PageContainer = React.forwardRef(function PageContainer(props, ref) {\n    var _a = React.useState(true), isAsideOpen = _a[0], setIsAsideOpen = _a[1];\n    var openAside = function () { return setIsAsideOpen(true); };\n    var closeAside = function () { return setIsAsideOpen(false); };\n    var bodyRef = React.useRef(null);\n    var footerRef = React.useRef(null);\n    return (React.createElement(PageContext.Provider, { value: {\n            bodyRef: bodyRef,\n            footerRef: footerRef,\n            aside: {\n                open: openAside,\n                close: closeAside,\n                isOpen: isAsideOpen,\n            },\n        } },\n        React.createElement(StyledPageContainer, __assign({}, props, { ref: ref }))));\n});\nvar PageMain = React.forwardRef(function PageMain(props, ref) {\n    var _a;\n    var attrs = (_a = {}, _a[pageLayoutRootDataAttr] = true, _a);\n    return (React.createElement(PageGrid, null,\n        React.createElement(StyledPageMain, __assign({}, props, attrs, { ref: ref }))));\n});\nvar PageBreadcrumbs = React.forwardRef(function PageBreadcrumbs(props, ref) {\n    return React.createElement(StyledPageBreadcrumbs, __assign({ ref: ref }, props));\n});\nvar PageBanner = React.forwardRef(function PageBanner(props, ref) {\n    return React.createElement(StyledPageBanner, __assign({ ref: ref }, props));\n});\nvar PageTitle = React.forwardRef(function PageTitle(props, ref) {\n    return React.createElement(StyledPageTitle, __assign({ ref: ref }, props));\n});\nvar PageTabs = React.forwardRef(function PageTabs(props, ref) {\n    return React.createElement(StyledPageTabs, __assign({ ref: ref }, props));\n});\nPageGrid.displayName = 'Page.Grid';\nPageHeader.displayName = 'Page.Header';\nPageBanner.displayName = 'Page.Banner';\nPageBreadcrumbs.displayName = 'Page.Breadcrumbs';\nPageTitle.displayName = 'Page.Title';\nPageTabs.displayName = 'Page.Tabs';\nPageBody.displayName = 'Page.Body';\nPageFooter.displayName = 'Page.Footer';\nPageAside.displayName = 'Page.Aside';\nPageContainer.displayName = 'Page';\nPageMain.displayName = 'Page.Main';\nexport var Page = addSubcomponents({\n    Header: PageHeader,\n    Banner: PageBanner,\n    Breadcrumbs: PageBreadcrumbs,\n    Title: PageTitle,\n    Tabs: PageTabs,\n    Footer: PageFooter,\n    Body: PageBody,\n    Main: PageMain,\n    Aside: PageAside,\n    // Grid utilities\n    Grid: PageGrid,\n    Column: NextGrid.Col,\n    Row: NextGrid.Row,\n}, PageContainer);\n"]},"metadata":{},"sourceType":"module"}